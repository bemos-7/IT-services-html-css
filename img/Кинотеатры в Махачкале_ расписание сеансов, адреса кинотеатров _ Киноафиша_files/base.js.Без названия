(()=>{var __webpack_modules__={848:(e,t,a)=>{"use strict";a.d(t,{z:()=>s});class s{constructor(e,t,a){this._declare(e,t,a),this._init(e)}_declare(e,t,a){this.el=e,this.param=t,this.data=a,this.name=t.name,this.eName=t.eName,this.event=void 0,this.observer=void 0,this.isDestroy=!1,this.status=!1,this.isRunner=!0}_init(){const e=this.eName;e&&"auto"!==e?"observe"===e?this._byObserve():this._byEvent():this._checkModule()}_checkModule(){this.status=!1;const e=APP.bases[this.name];e?this._callModule(e):this._importModule()}async _importModule(){const e=this.param.ver||1,t="./plugins/"+this.name+".js?"+e;try{this.param.preloader&&this.el.classList.add("js-loading");const e=await import(t);this.isDestroy||this._callModule(e[this.name])}catch(e){console.log("import module "+this.name+" err ",e)}}_callModule(e){void 0!==e&&(e.toString().match(/^class/)?this.status=new e(this.el,this.param,this.event,this.data,this):this.status=e(this.el,this.param,this.event,this.data,this))}_byEvent(){this._onEvent=e=>{this.param.prevent&&e.preventDefault(),this.event=e,this._checkModule()};const e=this.param.prevent?{once:!0,passive:!1}:{once:!0};this.el.addEventListener(this.param.eName,this._onEvent,e),this.status="listener"}_byObserve(){this.status=new IntersectionObserver(((e,t)=>{e.forEach((e=>{e.isIntersecting&&(t.disconnect(),this._checkModule())}))}),this.param.options||{}),this.status.observe(this.el)}destroy(){this.status&&("listener"===this.status?this.el.removeEventListener(this.param.eName,this._onEvent):this.status.disconnect?this.status.disconnect():this.status.destroy&&this.status.destroy()),this.isDestroy=!0}callbacks(){}}},402:()=>{!function(e){var t={};function a(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(s,i,function(t){return e[t]}.bind(null,i));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=1)}([function(module,__webpack_exports__,__nested_webpack_require_948__){"use strict";__nested_webpack_require_948__.d(__webpack_exports__,"a",(function(){return scriptonload2}));var scriptonload2=function(srcAll,callback){"string"==typeof srcAll&&(srcAll=[srcAll]);var isAborted=!1,total=srcAll.length,counter=-1,checkAll=function(){isAborted||(++counter===total&&callback?callback():new newScript(srcAll[counter]))},checkArr=function(e){for(var t=e.length,a={},s=!1,i=0;i<t;i++)s=s||a.hasOwnProperty(e[i]),a[e[i]]=e[i];return!s},abort=function(){isAborted=!0};class newScript{constructor(e){this._declare(e),this._checkScript()}_declare(e){this.param=e,this.uid="scriptonload-"+e.src.replace(/[^A-Za-z0-9]/g,"_"),this.script=document.scripts[this.uid]}_checkScript(){if(this.script)this.script.isLoading?this._addEvent():checkAll();else{let e=document.createElement("script");e.setAttribute("async",!1),e.setAttribute("src",this.param.src),e.setAttribute("id",this.uid),e.isLoading=!0,this.script=e,this._addEvent(),document.body.appendChild(e)}}_addEvent(){const checkGlobal=()=>{try{eval(this.param.global),this._onLoad(checkGlobal)}catch(e){requestAnimationFrame(checkGlobal)}};this.script.addEventListener("load",checkGlobal,!1)}_onLoad(e){this.script.removeEventListener("load",e,!1),this.script.isLoading=!1,checkAll()}}if(checkArr(srcAll))return checkAll(),{abort};var msg="scriptonload.js: Scripts are not unique!";try{console.error(msg)}catch(e){alert(msg)}}},function(e,t,a){e.exports=a(2)},function(e,t,a){"use strict";a.r(t);const s={sendStat:function(e,t){if(e){"string"==typeof e&&(e=[e]);for(var a=0,s=e.length;a<s;a++){var i=e[a],r=document.createElement("IMG");r.src=i,r.style.cssText="visibility:hidden;position:absolute;left:-9999px;top:-9999px;display:block;width:1px;height:1px;overflow:hidden;",r.setAttribute("data-stat",t),document.body.appendChild(r)}}}};var i=function(e,t){"string"==typeof e&&(e=[e]);var a=e.length,s=0,i=function(){++s===a&&t&&t()},r=function(e){this.addEventListener?(this.removeEventListener("load",r,!1),this.isLoading=!1,i()):"complete"!=this.readyState&&"loaded"!=this.readyState||(this.detachEvent("onreadystatechange",e),this.isLoading=!1,i())},o=function(e){e.addEventListener?e.addEventListener("load",r,!1):e.attachEvent("onreadystatechange",(function t(){r.call(e,t)}))};if(function(e){for(var t=e.length,a={},s=!1,i=0;i<t;i++)s=s||a.hasOwnProperty(e[i]),a[e[i]]=e[i];return!s}(e))for(var n=0;n<a;n++){var l="scriptonload-"+e[n].replace(/[^A-Za-z0-9]/g,"_"),d=document.scripts[l];d?d.isLoading?o(d):i():((d=document.createElement("script")).setAttribute("async",!1),d.setAttribute("src",e[n]),d.setAttribute("id",l),d.isLoading=!0,o(d),document.body.appendChild(d))}else{var c="scriptonload.js: Scripts are not unique!";try{console.error(c)}catch(e){alert(c)}}};class r{constructor(e){this.param=e,this.oUplayer=e.oUPlayer,this.callbacks=e.callbacks,this._createElements(),this._add(this.param.path)}_createElements(){this.data={},this.data.mediaFile=void 0,this.data.clickThrough=void 0,this.data.clickTrackingAll=[],this.data.impressionAll=[],this.data.errorAll=[],this.data.keyFrameAll=[0,25,50,75,100],this.data.statEventAll={},this.data.extOnVastLoadAll=[],this.wrappersCount=0,this.xhr=!1}_add(e){e?this._getXmlDoc(e,(e=>{const t=e.querySelector("Ad"),a=e.querySelectorAll("Error");if(a.length&&this._pushCDATA(a,"errorAll"),t){var s=t.querySelector("VideoClicks"),i=s?s.querySelectorAll("ClickTracking"):null,r=t.querySelectorAll("Impression"),o=t.querySelector("TrackingEvents"),n=t.querySelectorAll('Extensions Tracking[event="onVastLoad"]');if(this.data.clickThrough=function(){try{return s.querySelector("ClickThrough").childNodes[0].wholeText.replace(/^\s+/,"").replace(/\s+$/,"")}catch(e){return}}(),i&&this._pushCDATA(i,"clickTrackingAll"),r.length&&this._pushCDATA(r,"impressionAll"),o&&this._pushTrackingEvents(o),n.length&&this._pushCDATA(n,"extOnVastLoadAll"),"Wrapper"===t.firstElementChild.nodeName){this.wrappersCount++;var l=this._getAdURI(t);this._add(l)}else{var d=this._getAdvFile(t);if(this.callbacks.onVastTagLoaded(!!d,this.data.extOnVastLoadAll),d)if(this.data.mediaFile=d.file,"mp4"==d.type)this.data.skipoffset=this._getSkipoffset(t),this.callbacks.onVast(this.data);else{var c=t.querySelector("AdParameters");this.data.AdParameters=c?c.childNodes[0].wholeText.replace(/^\s+/,"").replace(/\s+$/,""):"",this.callbacks.onVpaid(this.data)}else{const e=403,t="Couldn’t find MediaFile that is supported by this video player, based on the attributes of the MediaFile element.";this._handleError({msg:t,vastCode:e})}}}else{let e,t;this.wrappersCount?(e="No Ads VAST response after one or more Wrappers!",t=302):(e="File not found. Unable to find Linear/MediaFile from URI.",t=401),this._handleError({msg:e,vastCode:t})}})):this._handleError("Путь к VAST тегу отсутствует")}_pushCDATA(e,t){var a=this;Array.prototype.forEach.call(e,(function(e){var s=e.childNodes[0];s&&a.data[t].push(s.wholeText.replace(/^\s+/,"").replace(/\s+$/,""))}))}_pushTrackingEvents(e){for(var t=e.querySelectorAll("Tracking"),a=0,s=t.length;a<s;a++)if(t[a].childNodes.length&&t[a].childNodes[0].wholeText&&t[a].getAttribute("event")){var i=t[a].getAttribute("event"),r=t[a].childNodes[0].wholeText.replace(/^\s+/,"").replace(/\s+$/,"");switch(i){case"start":i="0";break;case"firstQuartile":i="25";break;case"midpoint":i="50";break;case"thirdQuartile":i="75";break;case"complete":i="100"}this.data.statEventAll[i]||(this.data.statEventAll[i]=[]),this.data.statEventAll[i].push(r)}}_getAdvFile(e){var t=e.querySelector("MediaFiles"),a=!1,s=!1,i=!1;return!!t&&(Array.prototype.forEach.call(t.querySelectorAll("MediaFile"),(e=>{var t,r,o=e.getAttribute("type");if(("application/javascript"===o||"application/x-javascript"===o||"application/ecmascript"===o||"text/javascript"===o||"text/ecmascript"===o)&&"VPAID"===e.getAttribute("apiFramework"))return(i={}).type="VPAID",void(i.file=e.childNodes[0].wholeText.replace(/^\s+/,"").replace(/\s+$/,""));"video/mp4"===o&&(r=e.getAttribute("width"),t=Math.abs(r-640),(!a||t<s)&&(a=e,s=t))})),a&&((i={}).type="mp4",i.file=a.childNodes[0].wholeText.replace(/^\s+/,"").replace(/\s+$/,"")),i||!1)}_getXmlDoc(e,t){this.xhr=new XMLHttpRequest,this.xhr.withCredentials=!0,this.xhr.open("GET",e,!0),this.xhr.onload=()=>{var e=(new DOMParser).parseFromString(this.xhr.responseText,"text/xml");t(e)},this.xhr.timeout=2500,this.xhr.ontimeout=()=>{this.xhr.abort();const e="VAST xml грузится более установленного времени: "+this.xhr.timeout+"мс";this._handleError({msg:e,vastCode:900})},this.xhr.onerror=()=>{this._handleError("Ошибка загрузки XMLHttpRequest, например, блокировщик рекламы")},this.xhr.send(null)}_getAdURI(e){return e.querySelector("VASTAdTagURI").childNodes[0].wholeText.replace(/^\s+/,"").replace(/\s+$/,"")}_getSkipoffset(e){var t,a=void 0;if(t=e.querySelector("Linear").getAttribute("skipoffset"))a=t;else try{a=e.querySelector("Extensions").querySelector('Extension[type*="skipTime"]').childNodes[0].wholeText.replace(/^\s+/,"").replace(/\s+$/,"")}catch(e){return 5}if(!a)return 5;if(-1===a.indexOf("%")){var s=a.split(":"),i=void 0;return null==(i=2==s.length?60*parseInt(s[0])+1*parseInt(s[1]):60*parseInt(s[0])*60+60*parseInt(s[1])+1*parseInt(s[2]))&&(i=5),i}return 5}_handleError(e){"string"==typeof e&&(e={msg:e}),e.vastCode&&this.data.errorAll.length&&(()=>{this.data.errorAll.forEach(((t,a)=>{this.data.errorAll[a]=t.replace("[ERRORCODE]",e.vastCode)}))})(),this.oUplayer.helpers.sendStat(this.data.errorAll,"errorAll"),this.callbacks.onError(e)}destroy(){this.xhr&&this.xhr.abort()}}class o{constructor(e){this._createElements(e),this._insertVideoTag(),this._addEventsName(),this._addEvents(),this._run()}_getHtml(){return'<div data-js="adv-player" class="videoPlayerAds"><a data-js="adv-clicking-btn" class="videoPlayerAds_link" target="_blank">&nbsp;</a><div class="videoPlayerAds_controls"><div class="videoPlayerAds_controlsCell"><span class="videoPlayerAds_param">Реклама.</span> <span data-js="adv-left" class="videoPlayerAds_param">&nbsp;</span></div><div class="videoPlayerAds_controlsCell"><a data-js="adv-skip-btn" class="videoPlayerAds_param" href="#">&nbsp;</a></div></div><div class="videoPlayerAds_before"><div class="videoPlayerAds_beforeContent"><div class="videoPlayerAds_beforeContentItem">Реклама</div></div></div></div>'}_createElements(e){this.param=e,this.callbacks=e.callbacks,this.oUPlayer=e.oUPlayer,this.vastData=e.vastData,this.insert=this.oUPlayer.wrapper.querySelector('[data-videoPlayer-insert="adv"]'),this.insert.innerHTML=this._getHtml(),this.wrapper=this.insert.firstChild,this.video=this._createVideotag(),this.clickingBtn=this.vastData.clickThrough?this.wrapper.querySelector('[data-js="adv-clicking-btn"]'):void 0,this.skipBtn=this.wrapper.querySelector('[data-js="adv-skip-btn"]'),this.advLeft=this.wrapper.querySelector('[data-js="adv-left"]'),this.format="mp4",this.keyFrameAll=[],this.statEventAll={},this.isAdClickThru=!1}_createVideotag(){const e=this.oUPlayer.param;let t=this.oUPlayer.baseData.videoTag.cloneNode(!1);return t.removeAttribute("style"),t.innerHTML="",t.className="videoPlayerAds_video",this._checkMutedParam(t,e.muted),t}_checkMutedParam(e,t){"undefined"!==t&&(t?(e.setAttribute("muted",""),e.muted=!0):(e.removeAttribute("muted"),e.muted=!1))}_insertVideoTag(){this.wrapper.insertBefore(this.video,this.wrapper.firstElementChild)}_addEventsName(){this.eNames={},window.navigator.pointerEnabled?this.eNames={down:"pointerdown",move:"pointermove",enter:"pointerenter",leave:"pointerleave",up:"pointerup"}:window.navigator.msPointerEnabled?this.eNames={down:"MSPointerDown",move:"MSPointerMove",enter:"MSPointerEnter",leave:"MSPointerLeave",up:"MSPointerUp"}:"ontouchstart"in document.documentElement?this.eNames={down:"touchstart",move:"touchmove",enter:"touchstart",leave:"touchend",up:"touchend"}:this.eNames={down:"mousedown",move:"mousemove",enter:"mouseenter",leave:"mouseleave",up:"mouseup"}}_addEvents(){var e=this;this.video.onloadedmetadata=e=>{this._updateTimeCur(0),this._ready()},this.video.ontimeupdate=function(){if(isNaN(this.duration))return!1;e._updateTimeCur.call(e,this.currentTime)},this.video.onended=()=>{console.log("Adv player this.video.onended"),this._finish("completed")},this.skipBtn.onclick=function(){return e._skip.call(e),!1},this.clickingBtn&&(this.clickingBtn.onclick=()=>{this.isAdClickThru=!0,this._clicking()})}_skip(){if(this.skipBtn&&"Пропустить"!==this.skipBtn.innerHTML)return!1;this.video.pause(),this._finish("skipped"),this._sendStat(this.vastData.statEventAll.skip,"skip")}_clicking(){this._sendStat(this.vastData.clickTrackingAll,"clickTracking-vast"),this.param.callbacks.onClick({})}_reloadData(e){var t=document.createElement("SOURCE");this.clickingBtn&&this.clickingBtn.setAttribute("href",e.clickThrough),this.video.innerHTML="",t.setAttribute("src",e.mediaFile),t.setAttribute("type","video/"+this.format),this.video.appendChild(t),this.video.load()}_updateTimeCur(e){var t=this.video.duration,a=this.vastData.skipoffset,s=Math.floor(t-e),i=s?"Осталось "+s+"сек":"&nbsp;",r=Math.round(a-e);this.advLeft.innerHTML=i,this.skipBtn&&"Пропустить"!=this.skipBtn.innerHTML&&(a>=t?(this.skipBtn.style.display="none",this.skipBtn=void 0):this.skipBtn.innerHTML=r>0?"Пропустить через "+r:"Пропустить"),this._checkStat()}_checkStat(e){if(!this.vastData.keyFrameAll.length)return!1;if(e=e||Math.round(this.video.currentTime/this.video.duration*100),this.vastData.keyFrameAll[0]===e||this.vastData.keyFrameAll[0]<e){const t=this.vastData.keyFrameAll[0]+"";this._sendStat(this.vastData.statEventAll[t],t),this.vastData.keyFrameAll.shift(),this._checkStat(e)}}_finish(e){if(this.isFinish)return;this.isFinish=!0,this.oUPlayer.isShowAdv=!1;const t={reason:e,isAdClick:this.isAdClickThru};this.callbacks.onEnd(t)}_sendStat(e,t){if(e){"string"==typeof e&&(e=[e]);for(var a=0,s=e.length;a<s;a++){var i=e[a],r=document.createElement("IMG");r.src=i,r.style.cssText="visibility:hidden;position:absolute;left:-9999px;top:-9999px;display:block;width:1px;height:1px;overflow:hidden;",r.setAttribute("data-stat",t),document.body.appendChild(r)}}}_ready(){this.param.callbacks.onStart("vast"),this.video.play()}_run(){this._reloadData.call(this,this.vastData);for(var e=this.vastData.impressionAll,t=0,a=e.length;t<a;t++){var s=e[t],i=document.createElement("IMG");i.src=s,i.style.cssText="visibility:hidden;position:absolute;left:-9999px;top:-9999px;display:block;width:1px;height:1px;overflow:hidden;",document.body.appendChild(i)}}abort(){this.video.paused||this.video.pause()}destroy(){this.video.onloadedmetadata=function(){},this.video.innerHTML="",this.video.removeAttribute("src"),this.insert.innerHTML="",this.isDestroy=!0}}var n=a(0);class l{constructor(e){this._declare(e),this._insertVideoTag(),this._load()}_declare(e){this.param=e,this.oUPlayer=e.oUPlayer,this.callbacks=e.callbacks,this.insert=this.oUPlayer.wrapper.querySelector('[data-videoPlayer-insert="adv"]'),this.insert.innerHTML=this._getHtml(),this.wrapper=this.insert.firstChild,this.video=this._createVideotag(),this.slot=this.wrapper.querySelector('[data-js="vpaid-slot"]'),this.script=void 0,this.YaAbortController,this.isAdClickThru=!1}_getHtml(){return'<div data-js="adv-player" class="videoPlayerAds"><div data-js="vpaid-slot" id="qwe" style="position:absolute;left:0;top:0;display:block;width:100%;height:100%;"></div></div>'}_createVideotag(){const e=this.oUPlayer.param;let t=this.oUPlayer.baseData.videoTag.cloneNode(!1);return t.removeAttribute("style"),t.innerHTML="",t.className="videoPlayerAds_video",this._checkMutedParam(t,e.muted),t}_checkMutedParam(e,t){"undefined"!==t&&(t?(e.setAttribute("muted",""),e.muted=!0):(e.removeAttribute("muted"),e.muted=!1))}_insertVideoTag(){this.wrapper.insertBefore(this.video,this.slot)}_load(){this.script=Object(n.a)([{src:videoPlayer.settings.vendors.YaSDK,global:"ya.videoAd"}],this._onReady.bind(this))}_onReady(){delete this.script,this.isDestroy||ya.videoAd.loadModule("AdLoader").then((e=>{if(this.isDestroy)throw this;return e.AdLoader.create(this.param.agentParam.settings)})).then((e=>{if(this.isDestroy)throw this;return e.loadAd()})).then((e=>{if(this.isDestroy)throw this;const t=e.createPlaybackController(this.video,this.slot);t.subscribe("AdClickThru",(()=>{this.isAdClickThru=!0})),t.subscribe("AdStopped",(()=>{this._finish("completed")})),t.subscribe("AdPodSkipped",(()=>{this._finish("skipped")})),t.subscribe("AdPodClose",(()=>{this._finish("closed")})),this.callbacks.onStart(),t.playAd()})).catch((e=>{if(e===this)return;const t=e;this.callbacks.onError({msg:t})}))}_finish(e){if(this.isDestroy)return;this.isFinish=!0,this.oUPlayer.isShowAdv=!1;const t={reason:e,isAdClick:this.isAdClickThru};this.param.callbacks.onEnd(t)}abort(){}destroy(){this.script&&this.script.abort(),this.isDestroy=!0,this.insert.innerHTML=""}}class d{constructor(e){this._declare(e),this._insertVideoTag(),this._load()}_declare(e){this.param=e,this.oUPlayer=e.oUPlayer,this.callbacks=e.callbacks,this.insert=this.oUPlayer.wrapper.querySelector('[data-videoPlayer-insert="adv"]'),this.insert.innerHTML=this._getHtml(),this.wrapper=this.insert.firstChild,this.video=this._createVideotag(),this.slot=this.wrapper.querySelector('[data-js="vpaid-slot"]'),this.script=void 0,this.YaAbortController,this.isAdClickThru=!1,this.adsLoaded=!1,this.adDisplayContainer,this.adsLoader,this.adsManager}_getHtml(){return'<div data-js="adv-player" class="videoPlayerAds"><div data-js="vpaid-slot" id="qwe" style="position:absolute;left:0;top:0;display:block;width:100%;height:100%;"></div></div>'}_createVideotag(){const e=this.oUPlayer.param;let t=this.oUPlayer.baseData.videoTag.cloneNode(!1);return t.removeAttribute("style"),t.innerHTML="",t.className="videoPlayerAds_video",this._checkMutedParam(t,e.muted),t}_checkMutedParam(e,t){"undefined"!==t&&(t?(e.setAttribute("muted",""),e.muted=!0):(e.removeAttribute("muted"),e.muted=!1))}_insertVideoTag(){this.wrapper.insertBefore(this.video,this.slot)}_load(){this.script=Object(n.a)([{src:videoPlayer.settings.vendors.IMASDK,global:"google.ima"}],this._onReady.bind(this))}_onReady(){delete this.script,this.isDestroy||this._initializeIMA()}_initializeIMA(){this.adDisplayContainer=new google.ima.AdDisplayContainer(this.slot,this.video),this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer),this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(e=>{this.adsManager=e.getAdsManager(this.video),this.adsManager.addEventListener(google.ima.AdEvent.Type.CLICK,(()=>{this.isAdClickThru=!0})),this.adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,(()=>{this._finish("completed")})),this._loadAds()}),!1),this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>{this.adsManager&&this.adsManager.destroy(),this.callbacks.onError({msg:e.getError()})}),!1),this.video.addEventListener("ended",(()=>{this.adsLoader.contentComplete()}));var e=new google.ima.AdsRequest;e.adTagUrl=this.param.agentParam.path,e.linearAdSlotWidth=this.video.clientWidth,e.linearAdSlotHeight=this.video.clientHeight,e.nonLinearAdSlotWidth=this.video.clientWidth,e.nonLinearAdSlotHeight=this.video.clientHeight/3,this.adsLoader.requestAds(e)}_loadAds(){if(!this.adsLoaded){this.adsLoaded=!0,this.video.load(),this.adDisplayContainer.initialize();var e=this.video.clientWidth,t=this.video.clientHeight;try{this.callbacks.onStart(),this.adsManager.init(e,t,google.ima.ViewMode.NORMAL),this.adsManager.start()}catch(e){this.callbacks.onError({msg:e})}}}_finish(e){if(this.isDestroy)return;this.isFinish=!0,this.oUPlayer.isShowAdv=!1;const t={reason:e,isAdClick:this.isAdClickThru};this.param.callbacks.onEnd(t)}abort(){}destroy(){this.script&&this.script.abort(),this.isDestroy=!0,this.insert.innerHTML=""}}class c{constructor(e){this.param=e,this.adsParam=e.adsParam,this.agentParam=e.agentParam,this.oUPlayer=this.param.oUPlayer,this.callbacks=this.param.callbacks,this._declare(),this._getAdsData()}_declare(){this.oVpaidPlayer=void 0,this.oAdvPlayer=void 0,this.oYaSDK=void 0,this.timeout=this.agentParam.timeout||5e3,this.clearCancelAd=setTimeout((()=>{this.clearCancelAd=!1,this._cancelAd()}),this.timeout)}_getAdsData(){var e=this.agentParam.path,t=this.agentParam.name,a=this.agentParam.format;this.callbacks.onDataRequest(t),"YaSDK"===a?this.oYaSDK=new l({oUPlayer:this.oUPlayer,agentParam:this.agentParam,callbacks:{onStart:()=>{this._onStart("YaSDK")},onEnd:e=>{e.type="YaSDK",this.callbacks.onEnd(e)},onError:e=>{this._onError(e,"YaSDK")}}}):"IMASDK"===a?this.oYaSDK=new d({oUPlayer:this.oUPlayer,agentParam:this.agentParam,callbacks:{onStart:()=>{this._onStart("IMASDK")},onEnd:e=>{e.type="IMASDK",this.callbacks.onEnd(e)},onError:e=>{this._onError(e,"IMASDK")}}}):this.vastObj=new r({path:e,oUPlayer:this.oUPlayer,callbacks:{onVastTagLoaded:(e,t)=>{this.callbacks.onVastTagLoaded(t)},onVast:e=>{this.callbacks.onDataSuccess("vast"),this._onSuccessGetVastData(e)},onVpaid:e=>{this.callbacks.onDataSuccess("vpaid"),this._onSuccessGetVpaidData(e)},onError:e=>{e.name=this.agentParam.name,e.fromModule="VASTTag",this.callbacks.onError(e)}}})}_onStart(e){this._stopTimeout(),this.callbacks.onStart(e)}_onError(e,t){this._stopTimeout(),e.name=this.adsParam.name,e.fromModule=t,this.callbacks.onError(e)}_onSuccessGetVpaidData(e){delete this.vastObj,this.oVpaidPlayer=new class{constructor(e){this._createElements(e),this._insertVideoTag(),this._load()}_getHtml(){return'<div data-js="adv-player" class="videoPlayerAds"><div data-js="vpaid-slot" style="position:absolute;left:0;top:0;display:block;width:100%;height:100%;"></div></div>'}_createElements(e){this.param=e,this.oUPlayer=e.oUPlayer,this.vastData=e.vastData,this.callbacks=e.callbacks,this.insert=this.oUPlayer.wrapper.querySelector('[data-videoPlayer-insert="adv"]'),this.insert.innerHTML=this._getHtml(),this.wrapper=this.insert.firstChild,this.video=this._createVideotag(),this.slot=this.wrapper.querySelector('[data-js="vpaid-slot"]'),this.vpaid=!1,this.isFinish=!1,this.isAdLoaded=!1,this.isAdClickThru=!1}_createVideotag(){const e=this.oUPlayer.param;let t=this.oUPlayer.baseData.videoTag.cloneNode(!1);return t.removeAttribute("style"),t.innerHTML="",t.className="videoPlayerAds_video",this._checkMutedParam(t,e.muted),t}_checkMutedParam(e,t){"undefined"!==t&&(t?(e.setAttribute("muted",""),e.muted=!0):(e.removeAttribute("muted"),e.muted=!1))}_insertVideoTag(){this.wrapper.insertBefore(this.video,this.slot)}_load(){this.loadScriptInIFrame(this.vastData.mediaFile,(e=>{var t=this.insert.getBoundingClientRect();if(e.contentWindow.getVPAIDAd)this.isDestroy||(this.vpaid=e.contentWindow.getVPAIDAd(),this.vpaid.subscribe((()=>{this.isAdLoaded=!0,this.start()}),"AdLoaded"),this.vpaid.subscribe((()=>{this._sendStat(this.vastData.statEventAll.creativeView,"AdStarted")}),"AdStarted"),this.vpaid.subscribe((()=>{this._sendStat(this.vastData.impressionAll,"impression")}),"AdImpression"),this.vpaid.subscribe((()=>{this._sendStat(this.vastData.statEventAll[0],"start")}),"AdVideoStart"),this.vpaid.subscribe((()=>{this._sendStat(this.vastData.statEventAll[25],"firstQuartile")}),"AdVideoFirstQuartile"),this.vpaid.subscribe((()=>{this._sendStat(this.vastData.statEventAll[50],"midpoint")}),"AdVideoMidpoint"),this.vpaid.subscribe((()=>{this._sendStat(this.vastData.statEventAll[75],"thirdQuartile")}),"AdVideoThirdQuartile"),this.vpaid.subscribe((()=>{this._sendStat(this.vastData.statEventAll[100],"complete")}),"AdVideoComplete"),this.vpaid.subscribe((()=>{this._finish("completed")}),"AdStopped"),this.vpaid.subscribe(((e,t,a)=>{this._sendStat(this.vastData.clickTrackingAll,"clickTracking-vpaid"),this.isAdClickThru=!0,a&&window.open(e)}),"AdClickThru"),this.vpaid.subscribe((()=>{this._sendStat(this.vastData.statEventAll.skip,"skip"),this._finish("skipped")}),"AdSkipped"),this.vpaid.subscribe((()=>{this._finish("closed")}),"AdUserClose"),this.vpaid.subscribe((e=>{this.callbacks.onError({msg:"VPAID событие AdError (Ошибка показа рекламы)"})}),"AdError"),this.vpaid.initAd(t.width,t.height,"normal",0,{AdParameters:this.vastData.AdParameters},{slot:this.slot,videoSlot:this.video,videoSlotCanAutoPlay:!1}));else{const e="iframe.contentWindow.getVPAIDAd отсутствует";this.callbacks.onError({msg:e})}}))}start(){this.isDestroy||(this.callbacks.onStart(),this.vpaid.startAd())}_finish(e){if(this.isDestroy)return;if(this.isFinish)return;this.isFinish=!0,this.oUPlayer.isShowAdv=!1;const t={reason:e,isAdClick:this.isAdClickThru};this.param.callbacks.onEnd(t)}_sendStat(e,t){if(e){"string"==typeof e&&(e=[e]);for(var a=0,s=e.length;a<s;a++){var i=e[a],r=document.createElement("IMG");r.src=i,r.style.cssText="visibility:hidden;position:absolute;left:-9999px;top:-9999px;display:block;width:1px;height:1px;overflow:hidden;",r.setAttribute("data-stat",t),document.body.appendChild(r)}}}loadScriptInIFrame(e,t){var a=document.createElement("iframe");a.style.top="0",a.style.position="absolute",a.style.width="1px",a.style.height="1px",a.style.left="-90000px",a.onload=()=>{a.contentWindow.inDapIF=!0;var s=document.createElement("script");s.type="text/javascript",s.onload=function(){t(a)},s.onerror=e=>{this.callbacks.onError({msg:"videoPlayer: ошибка загрузки VPAID скрипта, например adBlock"})},a.contentWindow.document.body.appendChild(s),s.src=e},a.src="about:blank",document.body.appendChild(a)}abort(){}destroy(){try{this.vpaid.stopAd()}catch(e){}this.isDestroy=!0,this.insert.innerHTML=""}}({oUPlayer:this.oUPlayer,vastData:e,callbacks:{onError:e=>{this._onError(e,"Vpaid")},onStart:()=>{this._onStart("vpaid")},onEnd:e=>{e.type="vpaid",this.callbacks.onEnd(e)}}})}_onSuccessGetVastData(e){delete this.vastObj,this.oAdvPlayer=new o({oUPlayer:this.oUPlayer,vastData:e,callbacks:{onError:e=>{this._onError(e,"vast")},onStart:()=>{this._onStart("vast")},onEnd:e=>{e.type="vast",this.callbacks.onEnd(e)},onSkip:()=>{this.callbacks.onEnd("vast")},onClick:e=>{e.type="vast",this.callbacks.onClick(e)}}})}abort(){this.vastObj&&this.vastObj.destroy(),this.oAdvPlayer&&this.oAdvPlayer.abort(),this.oVpaidPlayer&&this.oVpaidPlayer.abort(),this.oYaSDK&&this.oYaSDK.abort()}_cancelAd(){this._stopTimeout(),this.callbacks.onTimeout("cancel Ad by time")}_stopTimeout(){this.clearCancelAd&&(clearTimeout(this.clearCancelAd),this.clearCancelAd=!1)}destroy(){this._stopTimeout(),this.vastObj&&(this.vastObj.destroy(),delete this.vastObj),this.oAdvPlayer&&(this.oAdvPlayer.destroy(),delete this.oAdvPlayer),this.oVpaidPlayer&&(this.oVpaidPlayer.destroy(),delete this.oVpaidPlayer),this.oYaSDK&&(this.oYaSDK.destroy(),delete this.oYaSDK)}}var h=class{constructor(e){this._createElements(e),this._addEventsName(),this._updateData(JSON.parse(this.wrapper.getAttribute("data-meter"))),this._addProgress("init",this._calculateRatioByValue()),this._addEvents()}_createElements(e){this.wrapper=e,this.progress=this.wrapper.querySelector('[data-js="progress"]'),this.slider=this.wrapper.querySelector('[data-js="slider"]'),this.data={min:0,max:1,value:0}}_addEventsName(){this.eNames={},window.navigator.pointerEnabled?this.eNames={down:"pointerdown",move:"pointermove",leave:"pointerleave",up:"pointerup"}:window.navigator.msPointerEnabled?this.eNames={down:"MSPointerDown",move:"MSPointerMove",leave:"MSPointerLeave",up:"MSPointerUp"}:"ontouchstart"in document.documentElement?this.eNames={down:"touchstart",move:"touchmove",leave:"touchend",up:"touchend"}:this.eNames={down:"mousedown",move:"mousemove",leave:"mouseleave",up:"mouseup"}}_updateData(e){for(var t in this.data)this.data[t]=void 0===e[t]?this.data[t]:e[t];this.curValue=this.data.value,this.data.delta=this.data.max-this.data.min}_addProgress(e,t){var a=100*t+"%";this.slider.style.left=a,this.progress.style.width=a,this.curValue=t*this.data.delta+this.data.min;try{this.callback(e,this.curValue)}catch(e){}}_addEvent(e,t,a){e.addEventListener?e.addEventListener(t,a,!1):e.attachEvent("on"+t,a)}_removeEvent(e,t,a){e.removeEventListener?e.removeEventListener(t,a,!1):e.detachEvent("on"+t,a)}_addEvents(){var e=this;e._circuitStartChange=function(t){e._startChange.call(e,t)},e._circuitChange=function(t){e._change.call(e,t)},e._circuit_stopChange=function(t){e._stopChange.call(e,t)},this._addEvent(this.wrapper,this.eNames.down,(function(t){(t=t||window.event).preventDefault(),e._startChange.call(e,t),e._addEvent(document.body,e.eNames.move,e._circuitChange),e._addEvent(document.body,e.eNames.leave,e._circuit_stopChange),e._addEvent(document.body,e.eNames.up,e._circuit_stopChange)}))}_startChange(e){e=(e=e||window.event).touches?e.touches[0]:e,this.startX=e.clientX,this.wrapperWidth=this.wrapper.getBoundingClientRect().right-this.wrapper.getBoundingClientRect().left,this.progressWidth=this.startX-this.wrapper.getBoundingClientRect().left;var t=Math.min(Math.max(0,this.progressWidth/this.wrapperWidth),1);this._addProgress("down",t)}_change(e){e=(e=e||window.event).targetTouches?e.targetTouches[0]:e,this._addProgress("move",this._calculateRatioByEvent(e))}_stopChange(e){e=(e=e||window.event).changedTouches?e.changedTouches[0]:e,this._removeEvent(document.body,this.eNames.move,this._circuitChange),this._removeEvent(document.body,this.eNames.leave,this._circuit_stopChange),this._removeEvent(document.body,this.eNames.up,this._circuit_stopChange),this._addProgress("up",this._calculateRatioByEvent(e))}_calculateRatioByEvent(e){var t=e.clientX-this.startX,a=(this.progressWidth+t)/this.wrapperWidth;return Math.min(Math.max(0,a),1)}_calculateRatioByValue(){return this.data.delta?(this.data.value-this.data.min)/this.data.delta:0}update(e){this._updateData(e),this._addProgress("update",this._calculateRatioByValue())}getValue(){return this.curValue}};class u{constructor(e){this.param=e,this.videoParam=e.videoParam,this.oUPlayer=this.param.oUPlayer,this.callbacks=this.param.callbacks,this._declare(),this._createPlayer()}_declare(){this.oHTMLPlayer=void 0,this.oYoutubePlayer=void 0}_createPlayer(){this.videoParam.youtube?this.oYoutubePlayer=new class{constructor(e){this.param=e,this._getYoutubeData()}_getYoutubeData(){var e=this,t=function(){window.isYouTubeIframeAPIReady?e._onYouTubeIframeAPIReady.call(e):setTimeout((function(){t()}),200)};window.onYouTubeIframeAPIReady?(console.warn("videoPlayer: onYouTubeIframeAPIReady is already exists"),window.onYouTubeIframeAPIReady=function(){window.isYouTubeIframeAPIReady=!0},i([videoPlayer.settings.vendors.youtube])):(window.onYouTubeIframeAPIReady=function(){window.isYouTubeIframeAPIReady=!0},i([videoPlayer.settings.vendors.youtube])),t()}_onYouTubeIframeAPIReady(){this._declare()}_declare(){this.oUPlayer=this.param.oUPlayer,this.callbacks=this.param.callbacks,this.insert=this.oUPlayer.wrapper.querySelector('[data-videoPlayer-insert="video"]'),this.insert.innerHTML='<div class="videoPlayer_youtube"></div>',this.youtubeIframe=this.insert.firstChild,this.isFullscreenMode=!1;var e=this;this.videoId=this._getVideoId(this.oUPlayer.param.youtube),this.YTPlayer=new YT.Player(this.youtubeIframe,{videoId:this.videoId,playerVars:{autoplay:1,mute:this._checkMutedParam(this.oUPlayer.param.muted),controls:this._checkControlsParam(this.oUPlayer.param.controls),end:this.oUPlayer.param.end,playsinline:1,iv_load_policy:3,rel:0,showinfo:0,modestbranding:1},events:{onReady:e=>{this.callbacks.onReady(e)},onStateChange:function(t){e._onPlayerStateChange.call(e,t)},onError:function(e){}}}),this._addEvents()}_getVideoId(e){return e.split("/").pop()}_checkMutedParam(e){return"undefined"===e?this.oUPlayer.baseData.isUserMuted?1:0:e?1:0}_checkControlsParam(e){return e||void 0===e?1:0}_addEvents(){var e,t="onfullscreenchange"in(e=document)?"fullscreenchange":"onmozfullscreenchange"in e?"mozfullscreenchange":"onwebkitfullscreenchange"in e?"webkitfullscreenchange":"onmsfullscreenchange"in e&&"msfullscreenchange",a=function(e){return"fullscreenElement"in e?"fullscreenElement":"mozFullScreenElement"in e?"mozFullScreenElement":"webkitFullscreenElement"in e?"webkitFullscreenElement":"msFullscreenElement"in e&&"msFullscreenElement"}(document);document.addEventListener(t,(function(e){document[a]==self.youtubeIframe?(self.isFullscreenMode=!0,self.oUPlayer._onFullscreen("youtube")):!0===self.isFullscreenMode&&(self.isFullscreenMode=!1,self.oUPlayer._onFullscreenExit("youtube"))}))}_onPlayerStateChange(e){if(1===e.data)this._playingCallback();else if(0===e.data){var t=document.exitFullscreen?"exitFullscreen":document.mozCancelFullScreen?"mozCancelFullScreen":document.webkitCancelFullScreen?"webkitCancelFullScreen":!!document.msExitFullscreen&&"msExitFullscreen";if(this.isFullscreenMode)try{document[t]()}catch(e){}this.callbacks.onEnd()}}_playingCallback(){this.isStart||(this.isStart=!0,this.callbacks.onStart())}initialize(){console.log("Youtube initialisation"),this.YTPlayer.playVideo(),this.YTPlayer.pauseVideo()}start(){this.oUPlayer.baseData.isUserMuted?this.YTPlayer.mute():this.YTPlayer.unMute(),this.YTPlayer.playVideo()}abort(){if(this.YTPlayer.getPlayerState&&2===this.YTPlayer.getPlayerState())return!1;this.YTPlayer.pauseVideo&&this.YTPlayer.pauseVideo()}destroy(){this.YTPlayer.destroy(),this.insert.innerHTML=""}}({oUPlayer:this.oUPlayer,callbacks:{onReady:()=>{},onEnd:()=>{this.callbacks.onEnd({reason:"Youtube Player видео проигралось до конца"})},onStart:()=>{this.callbacks.onStart({reason:"начало проигрывания Youtube плеера"})}}}):(this.oHTMLPlayer=new class{constructor(e){if(this._insertHTML(e),this._createElements(e),this._createShare(),this._insertVideoTag(),this._resetStat(),this._addEventsName(),!this._defineTech())return!1;this._resetNativeVideo(),this._initMute(),this._initVolume(),this._initRewind(),this._initBuffered(),this._initEmbed(),this._addEvents(),this._addToggle(),this._getQuality(),this._addQuality(),this._addFullscreen(),this._addSharePanel(),this._addFooterPanel()}_getHtml(e){var t=!!e.files.low&&e.files.low.path.replace(/\.mp4$/,""),a=!!e.files.high&&e.files.high.path.replace(/\.mp4$/,""),s='"LQ": "'+t+'"'+(a?', "HQ": "'+a+'"':"");const i=e.share?'<div data-js="share-btn" class="videoPlayerHtml_shareBtn videoPlayerHtml_controlsBtn">&lt;/&gt;</div>':"",r=e.share&&e.share.link?'<div class="videoPlayerHtml_shareItem"><div class="videoPlayerHtml_shareCell videoPlayerHtml_shareCell-title">Ссылка на ролик</div><div class="videoPlayerHtml_shareCell"><input readonly class="videoPlayerHtml_shareField videoPlayerHtml_shareField-insert" type="text" value="'+e.share.link+'" /></div><div class="videoPlayerHtml_shareCell videoPlayerHtml_shareCell-shrink">&nbsp;</div></div>':"",o=e.share&&e.share.embed?'<div class="videoPlayerHtml_shareItem"><div class="videoPlayerHtml_shareCell videoPlayerHtml_shareCell-title">Код для вставки</div><div class="videoPlayerHtml_shareCell videoPlayerHtml_shareCell-shrink"><span class="videoPlayerHtml_shareNote">ширина</span><input data-js="embed-width" class="videoPlayerHtml_shareField videoPlayerHtml_shareField-size" type="text" value="'+e.share.embed.width+'" /><span class="videoPlayerHtml_shareNote">высота</span><input data-js="embed-height" class="videoPlayerHtml_shareField videoPlayerHtml_shareField-size" type="text" value="'+e.share.embed.height+'" /></div><div class="videoPlayerHtml_shareCell"><input data-js="embed" readonly class="videoPlayerHtml_shareField videoPlayerHtml_shareField-insert" type="text" value=\''+e.share.embed.code+'\' /></div><div class="videoPlayerHtml_shareCell videoPlayerHtml_shareCell-shrink">&nbsp;</div></div>':"";return'<div data-js="html-player" data-quality=\'{'+s+'}\' class="videoPlayerHtml"><template data-js="video"></template><div data-js="toggle" class="videoPlayerHtml_toggle"><img class="videoPlayerHtml_bigPauseBtn" src="https://video.kinoafisha.info/i/player/pause-btn.png" alt="" /></div><div data-js="footer" class="videoPlayerHtml_footer"><div data-js="controls" class="videoPlayerHtml_controls"><div class="videoPlayerHtml_controlsCell videoPlayerHtml_controlsCell-shrink"><img  class="videoPlayerHtml_logo" src="https://video.kinoafisha.info/i/player/logo.png" alt="" /></div><div class="videoPlayerHtml_controlsCell videoPlayerHtml_controlsCell-shrink"><div class="videoPlayerHtml_playback videoPlayerHtml_controlsBtn"><img data-js="play"  class="videoPlayerHtml_playBtn" src="https://video.kinoafisha.info/i/player/play.png" alt="" /><img data-js="pause"  class="videoPlayerHtml_pauseBtn" src="https://video.kinoafisha.info/i/player/pause.png" alt="" /></div><div class="videoPlayerHtml_time"><span data-js="timeCur" class="videoPlayerHtml_timeCur"></span><span class="videoPlayerHtml_timeSep">/</span><span data-js="timeDur" class="videoPlayerHtml_timeDur"></span></div></div><div class="videoPlayerHtml_controlsCell"><div data-js="rewind" data-meter = \'{}\'  class="videoPlayerMeter  videoPlayerHtml_controlsBtn"><div class="videoPlayerMeter-strip"></div><div data-js="buffered" class="videoPlayerMeter-buffered"></div><div data-js="progress" class="videoPlayerMeter-progress"></div><div data-js="slider" class="videoPlayerMeter-slider"></div></div></div><div class="videoPlayerHtml_controlsCell  videoPlayerHtml_controlsCell-shrink"><span data-js="quality" class="videoPlayerHtml_qualityBtn videoPlayerHtml_controlsBtn">hq</span><div data-js="mute" class="videoPlayerHtml_mute videoPlayerHtml_controlsBtn"><img  data-js="mute-on" data-js="mute-on"  class="videoPlayerHtml_muteOn" src="https://video.kinoafisha.info/i/player/mute-on.png" alt="" /><img  data-js="mute-off" data-js="mute-off"  class="videoPlayerHtml_muteOff" src="https://video.kinoafisha.info/i/player/mute-off.png" alt="" /></div><div data-js="volume" data-meter = \'{"value": 1}\'  class="videoPlayerMeter videoPlayerMeter_volume videoPlayerHtml_controlsBtn"><div class="videoPlayerMeter-strip"></div><div data-js="progress" class="videoPlayerMeter-progress"></div><div data-js="slider" class="videoPlayerMeter-slider"></div></div><div data-js="fullscreen" class="videoPlayerHtml_fullscreen videoPlayerHtml_controlsBtn"> <img data-js="fullscreen-request"  class="videoPlayerHtml_fullscreenRequest" src="https://video.kinoafisha.info/i/player/fullscreen-request.png" alt="" /><img data-js="fullscreen-exit"  class="videoPlayerHtml_fullscreenExit" src="https://video.kinoafisha.info/i/player/fullscreen-exit.png" alt="" /></div>'+i+"</div></div>"+(e.share?'<div data-js="share" class="videoPlayerHtml_share">'+r+o+"</div>":"")+"</div></div>"}update(){const e=this.oUPlayer.param;if(e.files){var t=!!e.files.low&&e.files.low.path.replace(/\.mp4$/,""),a=!!e.files.high&&e.files.high.path.replace(/\.mp4$/,""),s='"LQ": "'+t+'"'+(a?', "HQ": "'+a+'"':"");this.wrapper.dataset.quality="{"+s+"}",this.dataQuality=JSON.parse(this.wrapper.getAttribute("data-quality")),this._getQuality()}}_insertHTML(e){const t=e.oUPlayer.param;this.insert=e.oUPlayer.wrapper.querySelector('[data-videoPlayer-insert="video"]'),this.insert.innerHTML=this._getHtml(t)}_createElements(e){this.param=e,this.oUPlayer=e.oUPlayer,this.callbacks=e.callbacks,this.paramPlayer=this.oUPlayer.param;var t=this;this.wrapper=this.insert.firstChild,this.video=this._createVideotag(),this.sourceTag=this.wrapper.querySelector('[data-js="source"]'),this.footer=this.wrapper.querySelector('[data-js="footer"]'),this.controls=this.footer.querySelector('[data-js="controls"]'),this.clearControls,this.playBtn=this.controls.querySelector('[data-js="play"]'),this.pauseBtn=this.controls.querySelector('[data-js="pause"]'),this.qualityBtn=this.controls.querySelector('[data-js="quality"]'),this.timeDur=this.controls.querySelector('[data-js="timeDur"]'),this.timeCur=this.controls.querySelector('[data-js="timeCur"]'),this.buffered=this.controls.querySelector('[data-js="buffered"]'),this._onBuffered=function(e){try{var a=Math.floor(t.video.buffered.end(0)/t.video.duration*100);t.buffered.style.width=a+"%"}catch(e){}},this.toggle=this.wrapper.querySelector('[data-js="toggle"]'),this.controlsDur=3e3,this.format,this.quality,this.dataQuality=JSON.parse(this.wrapper.getAttribute("data-quality")),this.keyFrameAll,this.isFullscreenMode=!1}_createShare(){this._createSharePanel()&&(this._createShareLinkBox(),this._createShareEmbedBox())}_createSharePanel(){if(this.isSharePanel=!!this.oUPlayer.param.share,this.isSharePanel)return this.shareBtn=!!this.oUPlayer.param.share&&this.controls.querySelector('[data-js="share-btn"]'),this.sharePanel=this.footer.querySelector('[data-js="share"]'),!0}_createShareLinkBox(){}_createShareEmbedBox(){this.isEmbedBox=!!this.oUPlayer.param.share.embed,this.isEmbedBox&&(this.embedField=this.sharePanel.querySelector('[data-js="embed"]'),this.embedWidthField=this.sharePanel.querySelector('[data-js="embed-width"]'),this.embedHeightField=this.sharePanel.querySelector('[data-js="embed-height"]'),this.embedTemplate=this.embedField.value,this.embedWidth=640,this.aspectRatio=.5625)}_createVideotag(){const e=this.oUPlayer.param;let t=this.oUPlayer.baseData.videoTag.cloneNode(!1);return t.removeAttribute("style"),t.setAttribute("class","videoPlayerHtml_video"),t.setAttribute("preload","metadata"),t.setAttribute("controls","controls"),this._checkMutedParam(t,e.muted),e.poster?t.innerHTML='<source data-js="source" src="'+e.files.low.path+'" type="video/mp4" /><a class="videoPlayerHtml_altVideo" href="'+e.files.low.path+'"  style="background-image:url('+e.poster+')"><img class="videoPlayerHtml_altVideoPoster" src="'+e.poster+'" alt="" /><img class="videoPlayerHtml_altVideoBtn" src="https://video.kinoafisha.info/i/player/play-btn.png" alt="" /></a>':t.innerHTML='<source data-js="source" src="'+e.files.low.path+'" type="video/mp4" /><a class="videoPlayerHtml_altVideo" href="'+e.files.low.path+'" ><img class="videoPlayerHtml_altVideoBtn" src="https://video.kinoafisha.info/i/player/play-btn.png" alt="" /></a>',t}_checkMutedParam(e,t){"undefined"!==t&&(t?(e.setAttribute("muted",""),e.muted=!0):(e.removeAttribute("muted"),e.muted=!1))}_insertVideoTag(){this.wrapper.querySelector('[data-js="video"]').replaceWith(this.video)}_resetStat(){this.keyFrameAll=[0,50,90,100]}_checkStat(){if(!this.keyFrameAll.length)return!1;var e=Math.round(this.video.currentTime/this.video.duration*100);(this.keyFrameAll[0]===e||this.keyFrameAll[0]<e)&&(this._sendStat(this.keyFrameAll[0]),this.keyFrameAll.shift(),this._checkStat())}_sendStat(e){}_addEventsName(){this.eNames={},window.navigator.pointerEnabled?this.eNames={down:"pointerdown",move:"pointermove",enter:"pointerenter",leave:"pointerleave",up:"pointerup"}:window.navigator.msPointerEnabled?this.eNames={down:"MSPointerDown",move:"MSPointerMove",enter:"MSPointerEnter",leave:"MSPointerLeave",up:"MSPointerUp"}:"ontouchstart"in document.documentElement?this.eNames={down:"touchstart",move:"touchmove",enter:"touchstart",leave:"touchend",up:"touchend"}:this.eNames={down:"mousedown",move:"mousemove",enter:"mouseenter",leave:"mouseleave",up:"mouseup"}}_defineFormat(){return this.video.canPlayType&&this.video.canPlayType("video/mp4")?this.format="mp4":this.format=!1,!!this.format}_defineTech(){return!(!document.addEventListener||!this._defineFormat())}_resetNativeVideo(){this.video.removeAttribute("controls"),this.video.removeAttribute("poster"),this.video.innerHTML=""}_initMute(){this.mute=this.controls.querySelector('[data-js="mute"]'),this.muteOn=this.mute.querySelector('[data-js="mute-on"]'),this.muteOff=this.mute.querySelector('[data-js="mute-off"]');var e=this;this.muteOn.onclick=function(){e.video.muted=!0;try{localStorage.videoMuted="on"}catch(e){}},this.muteOff.onclick=function(){e.video.muted=!1;try{localStorage.videoMuted="off"}catch(e){}},this.video.onvolumechange=function(){e.mute.className=!0===e.video.muted?e.mute.className.replace(/\s*videoPlayerHtml_mute_off/,"")+" videoPlayerHtml_mute_off":e.mute.className.replace(/\s*videoPlayerHtml_mute_off/,"")},this.video.onvolumechange()}_initVolume(){var e=this.controls.querySelector('[data-js="volume"]'),t=this;try{void 0!==localStorage.videoVolume&&(e.setAttribute("data-meter",'{"value": '+localStorage.videoVolume+"}"),t.video.volume=localStorage.videoVolume)}catch(e){}new h(e).callback=function(e,a){if(t.video.volume=a,"up"===e)try{localStorage.videoVolume=a}catch(e){}}}_initRewind(){var e,t;e=this.controls.querySelector('[data-js="rewind"]'),t=this,this.rewind=new h(e),this.rewind.callback=function(e,a){"down"===e?(t.isRewind=!0===t.video.paused?"paused":"playing",t.video.pause(),t.video.currentTime=a):"move"===e?t.video.currentTime=a:"up"===e&&(t.video.currentTime=a,"playing"===t.isRewind&&t.video.play(),t.isRewind=!1)}}_initBuffered(){this.video.addEventListener("progress",this._onBuffered,!1)}_initEmbed(){if(this.isEmbedBox){var e=this;this.embedWidthField.onkeyup=function(){var t=parseInt(this.value)||0;e._changeEmbed.call(e,t,t*e.aspectRatio)},this.embedHeightField.onkeyup=function(){var t=parseInt(this.value)||0;e._changeEmbed.call(e,t/e.aspectRatio,t)}}}_changeEmbed(e,t){this.isEmbedBox&&(e=parseInt(e)||"",t=parseInt(t)||"",this.embedWidthField.value=e,this.embedHeightField.value=t,this.embedField.value=this.embedTemplate.replace(/height="\d+"/,'height="'+t+'"').replace(/width="\d+"/,'width="'+e+'"'))}_addEvents(){var e=this;this.playBtn.onclick=function(){e.video.play()},this.pauseBtn.onclick=function(){e.video.pause()},this.video.onloadedmetadata=function(t){e._reloadTime.call(e),e._reloadRewind.call(e),e._reloadBuffered.call(e),e._reloadAspectRatio.call(e),e._reloadEmbed.call(e),e._ready.call(e)},this.video.onpause=function(){e.isRewind||e._pauseCallback.call(e)},this.video.onplaying=function(){e._playingCallback.call(e)},this.video.onended=()=>{this.isRewind||(this._endCallback("HTMLPlayer видео проигралось до конца"),this.fullscreenExit.onclick())},this.video.onwaiting=function(){},this._addEventTimeupdate()}_addEventTimeupdate(){this.video.addEventListener("timeupdate",this._timeupdateCallback.bind(this)),this.oUPlayer.param.end&&this.video.addEventListener("timeupdate",this._checkEndVideoFromParam.bind(this,this.oUPlayer.param.end))}_addToggle(){var e=this;this.toggle["on"+this.eNames.down]=function(t){e._toggle.call(e,t)}}_addFooterPanel(){var e=this;this.wrapper["on"+this.eNames.enter]=function(){e._showControlsAtTime.call(e)},this.wrapper["on"+this.eNames.leave]=function(){e._hideControlsAtTime.call(e)},this.wrapper["on"+this.eNames.move]=function(){e._showControlsAtTime.call(e)},this.footer["on"+this.eNames.enter]=function(){e.wrapper["on"+e.eNames.enter]=function(){},e.wrapper["on"+e.eNames.move]=function(){},e._showControls.call(e)},this.footer["on"+this.eNames.leave]=function(){e.wrapper["on"+e.eNames.enter]=function(){e._showControlsAtTime.call(e)},e.wrapper["on"+e.eNames.move]=function(){e._showControlsAtTime.call(e)}}}_toggle(e){("mousedown"===e.type||e.pointerType&&"mouse"===e.pointerType)&&(this.video.paused?this.video.play():this.video.pause())}_playingCallback(){this.isStart||(this.isStart=!0,this.callbacks.onStart()),this.wrapper.className=this.wrapper.className.replace(/\s*(videoPlayerHtml-pause|videoPlayerHtml-playing)/g,"")+" videoPlayerHtml-playing"}_pauseCallback(){this.wrapper.className=this.wrapper.className.replace(/\s*(videoPlayerHtml-pause|videoPlayerHtml-playing)/g,"")+" videoPlayerHtml-pause"}_endCallback(e){this.wrapper.className=this.wrapper.className.replace(/\s*(videoPlayerHtml-pause|videoPlayerHtml-playing)/g,""),this.callbacks.onEnd(e)}_timeupdateCallback(){this._updateTimeCur(this.video.currentTime),this._updateRewind(this.video.currentTime,this.video.duration)}_checkEndVideoFromParam(e){this.video.currentTime<e||this._endCallback("HTMLPlayer видео проигралось до значения, указанного в параметрах")}_showControls(){this._clearControlsAtTime(),this.wrapper.className=this.wrapper.className.replace(/\s*videoPlayerHtml-footer/,"")+" videoPlayerHtml-footer"}_showControlsAtTime(){this._clearControlsAtTime(),this._showControls(),this._hideControlsAtTime()}_clearControlsAtTime(){try{clearTimeout(this.clearControls)}catch(e){}}_hideControls(){this._clearControlsAtTime(),this.wrapper.className=this.wrapper.className.replace(/\s*videoPlayerHtml-(footer|share)/g,"")}_hideControlsAtTime(){var e=this;this._clearControlsAtTime(),this.clearControls=setTimeout((function(){e._hideControls.call(e)}),this.controlsDur)}_getQuality(){if(Object.keys(this.dataQuality).length>1)try{localStorage.videoQuality&&this.dataQuality[localStorage.videoQuality]?this.quality=localStorage.videoQuality:this.dataQuality.HQ&&screen.height>1079?this.quality="HQ":this.quality="LQ"}catch(e){this.quality="LQ"}else this.quality="LQ"}_addQuality(){if(Object.keys(this.dataQuality).length>1){var e=this;this.qualityBtn.className=this.qualityBtn.className+" videoPlayerHtml_qualityBtn-"+this.quality,this.qualityBtn.onclick=function(){e._changeQuality.call(e)}}else this.qualityBtn.style.display="none"}_changeQuality(){var e=this.qualityBtn.className.replace(" videoPlayerHtml_qualityBtn-"+this.quality,"");this.quality="HQ"===this.quality?"LQ":"HQ";try{localStorage.videoQuality=this.quality}catch(e){}this.qualityBtn.className=e+" videoPlayerHtml_qualityBtn-"+this.quality,this._reloadVideo()}_addFullscreen(){var e;if(this.fullscreen=this.controls.querySelector('[data-js="fullscreen"]'),this.fullscreenRequest=this.fullscreen.querySelector('[data-js="fullscreen-request"]'),this.fullscreenExit=this.fullscreen.querySelector('[data-js="fullscreen-exit"]'),!("fullscreenEnabled"in(e=document))&&!("mozFullScreenEnabled"in e||"webkitFullscreenEnabled"in e||"msFullscreenEnabled"in e))return"iphone"===videoPlayer.mobileAgent?this._addIphoneFullscreen():this.fullscreen.style.display="none",!1;var t,a=this,s=function(e){return"onfullscreenchange"in e?"fullscreenchange":"onmozfullscreenchange"in e?"mozfullscreenchange":"onwebkitfullscreenchange"in e?"webkitfullscreenchange":"onmsfullscreenchange"in e&&"msfullscreenchange"}(document),i=function(e){return"fullscreenElement"in e?"fullscreenElement":"mozFullScreenElement"in e?"mozFullScreenElement":"webkitFullscreenElement"in e?"webkitFullscreenElement":"msFullscreenElement"in e&&"msFullscreenElement"}(document),r=(t=this.wrapper).requestFullscreen?"requestFullscreen":t.mozRequestFullScreen?"mozRequestFullScreen":t.webkitRequestFullscreen?"webkitRequestFullscreen":!!t.msRequestFullscreen&&"msRequestFullscreen",o=document.exitFullscreen?"exitFullscreen":document.mozCancelFullScreen?"mozCancelFullScreen":document.webkitCancelFullScreen?"webkitCancelFullScreen":!!document.msExitFullscreen&&"msExitFullscreen";document.addEventListener(s,(function(e){a.wrapper===document[i]?(a._showFullscreen.call(a),a.isFullscreenMode=!0,a.oUPlayer._onFullscreen("HTML")):!0===a.isFullscreenMode&&(a._hideFullscreen.call(a),a.isFullscreenMode=!1,a.oUPlayer._onFullscreenExit("HTML"))})),this.fullscreenRequest.onclick=function(){r?a.wrapper[r]():alert("К сожалению, ваш браузер не поддерживает фуллскрин")},this.fullscreenExit.onclick=function(){a.wrapper===document[i]&&(o?document[o]():alert("Нажмите кнопку ESC для выхода из полноэкранного режима"))}}_addIphoneFullscreen(){this.fullscreenRequest.onclick=()=>{this.video.webkitEnterFullscreen()}}_showFullscreen(){this.wrapper.className=this.wrapper.className.replace(/\s*videoPlayerHtml-fullscreen/,"")+" videoPlayerHtml-fullscreen"}_hideFullscreen(){this.wrapper.className=this.wrapper.className.replace(/\s*videoPlayerHtml-fullscreen/,"")}_addSharePanel(){if(this.shareBtn){var e=this;this.shareBtn.onclick=function(){-1!==e.wrapper.className.indexOf("videoPlayerHtml-share")?e.wrapper.className=e.wrapper.className.replace(/\s*videoPlayerHtml-share/,""):e.wrapper.className=e.wrapper.className+" videoPlayerHtml-share"}}}_reloadVideo(){this.wrapper.className=this.wrapper.className.replace(/\s*videoPlayerHtml-(ready|playing|pause)/g,""),this.isStart=!1,this.video.innerHTML="";var e=document.createElement("SOURCE");e.setAttribute("src",this.dataQuality[this.quality]+"."+this.format),e.setAttribute("type","video/"+this.format),this.video.appendChild(e),this.video.load()}_reloadTime(){this._updateTimeDur(this.video.duration),this._updateTimeCur(0)}_reloadRewind(){this.rewind.update({value:0,max:this.video.duration})}_reloadBuffered(){this.buffered.style.width="0%"}_reloadAspectRatio(){}_reloadEmbed(){var e=this.embedWidth*this.aspectRatio;this._changeEmbed(this.embedWidth,e)}_updateTimeCur(e){this.timeCur.innerHTML=this._convertTime(e)}_updateTimeDur(e){this.timeDur.innerHTML=this._convertTime(e)}_updateRewind(e,t){this.isRewind||(this.rewind.update({value:e,max:t}),this._checkStat())}_convertTime(e){function t(e){return(e=Math.floor(e))<10?"0"+e:e}var a=t(e/3600%24);return(a="00"===a?"":a+":")+t(e/60%60)+":"+t(e%60)}async _ready(){var e=this.wrapper.className.replace(/\s*videoPlayerHtml-(ready|disabled)/g,"")+" videoPlayerHtml-ready";try{await this.video.play()}catch(e){this.video.removeAttribute("muted"),this.video.muted=!0,this.video.play()}this._showControlsAtTime(),this.wrapper.className=e}initialize(){this.video.innerHTML="",this.video.load()}start(){this._reloadVideo()}abort(){this.video.paused||(this.wrapper.className=this.wrapper.className.replace(/\s*(videoPlayerHtml-pause|videoPlayerHtml-playing)/g,""),this.video.pause())}destroy(){this.video.onloadedmetadata=function(){},this.video.innerHTML="",this.video.setAttribute("src",""),this.insert.innerHTML=""}}({oUPlayer:this.oUPlayer,callbacks:{onEnd:e=>{this.callbacks.onEnd({reason:e})},onStart:()=>{this.callbacks.onStart({reason:"начало проигрывания HTML плеера"})}}}),this.oHTMLPlayer.start())}_onStart(e){this._stopTimeout(),this.callbacks.onStart(e)}destroy(){this.oHTMLPlayer&&this.oHTMLPlayer.destroy(),this.oYoutubePlayer&&this.oYoutubePlayer.destroy()}}const p=class{constructor(e,t,a){this.helpers=s,this.wrapper=e,this.baseData=t,this.param=a,this.callbacks=a.callbacks,this.name=this.param.name,this.isShowAdv=!!this.param.ads,this.isRunning=!1,this._insertHTML(e),this.btn=this.wrapper.querySelector("[data-videoPlayer-btn]"),this.AdsManager=void 0,this.VideoManager=void 0,this.HTMLDataApi,this.callbacks=this.callbacks||{},this.callbacks.onRun=this.callbacks.onRun||(()=>{}),this.callbacks.onEnd=this.callbacks.onEnd||(()=>{}),this.callbacks.video=this.callbacks.video||(()=>{}),this.callbacks.video.onEnd=this.callbacks.video.onEnd||(()=>{}),this.callbacks.video.onStart=this.callbacks.video.onStart||(()=>{}),this.callbacks.ads=this.callbacks.ads||(()=>{}),this.callbacks.ads.onDataRequest=this.callbacks.ads.onDataRequest||(()=>{}),this.callbacks.ads.onEnd=this.callbacks.ads.onEnd||(()=>{}),this.callbacks.ads.onError=this.callbacks.ads.onError||(()=>{}),this.callbacks.ads.onClick=this.callbacks.ads.onClick||(()=>{}),this._onReady(),this._addEvents()}_onReady(){this.param.autoplay&&this.play(),this.wrapper.classList.remove("js-loading")}_insertHTML(){var e=this;let t="",a="";!1!==this.param.preview&&(t=-1!==e.param.poster.indexOf(".mp4")?'<div class="videoPlayer_preview"><video loop muted autoplay class="videoPlayer_preview_video" src="'+e.param.poster+'"></video>':'<div class="videoPlayer_preview" style="background-image:url('+e.param.poster+')">',a='<a data-videoPlayer-btn class="videoPlayer_playBtn" href="#"></a>');const s='<div data-videoPlayer-insert="adv" class="videoPlayer_insert videoPlayer_insert-adv"></div><div data-videoPlayer-insert="video" class="videoPlayer_insert videoPlayer_insert-video"></div>'+t+a+"</div>";this.wrapper.insertAdjacentHTML("afterbegin",s)}_addEvents(){!function(e,t,a){a=a||window;var s=!1;a.addEventListener("resize",(function(){s||(s=!0,requestAnimationFrame((function(){a.dispatchEvent(new CustomEvent("optimizedResize")),s=!1})))}))}(),this.btn&&this.btn.addEventListener("click",(e=>{e.preventDefault(),this.play()}))}play(){this.isRunning||(this.isRunning=!0,this.callbacks.onRun(),videoPlayer.abortAll(this),this.isShowAdv?this._runAds():this._runVideo())}stop(e,t=!1){this.isRunning&&(this.isRunning=!1,this.AdsManager&&(this.AdsManager.destroy(),this.AdsManager=void 0),this.VideoManager&&(this.VideoManager.destroy(),this.VideoManager=void 0),t?this.wrapper.classList.add("js-loading"):(this.wrapper.classList.remove("js-loading"),this.wrapper.className=this.wrapper.className.replace(/ js-active(-video|-adv)*/g,"")),this.callbacks.onEnd(e),this._sendEventMessage("ended"),this.isShowAdv=!!this.param.ads)}replay(e,t=!1){if(this.stop({reason:"Останавливаем плеер из-за вызова ф-ии replay"},!0),t)this.param=e;else if(e){e.files&&this.param.youtube&&delete this.param.youtube;for(let t in e)e.hasOwnProperty(t)&&(this.param[t]=e[t])}this.play()}_runAds(){this.wrapper.classList.add("js-loading"),this.wrapper.classList.remove("js-active","js-active-video","js-active-adv"),this.AdsManager||(this.AdsManager=new class{constructor(e){this._declare(e)}run(e){this.isInit||this.init(e),this._checkQueue()}_declare(e){this.param=e,this.adsParam=e.adsParam,this.oUPlayer=this.param.oUPlayer,this.callbacks=this.param.callbacks,this.queue=this._orderQueue(),this.Ads=void 0,this.isInit=!0,this.totalImpressions=1,this.impressionsCount=0,this.queueInd=-1}_reset(){this.totalImpressions=1,this.impressionsCount=0,this.queueInd=-1}_orderQueue(){if(!this.adsParam.order)return this.adsParam.queue;if("randomWeighted"===this.adsParam.order){const e=function(e,t){var a=e-.5+Math.random()*(t-e+1);return Math.round(a)};return function(t){return t.sort(((t,a)=>e(1,t.weight+a.weight)>a.weight?-1:1))}(this.adsParam.queue)}}_checkQueue(){if(this.totalImpressions===this.impressionsCount)this.callbacks.onEnd();else{this.queueInd++;const e=this.queue[this.queueInd];e?(this.callbacks.onCheckedQueue(e),this.Ads=new c({adsParam:this.adsParam,agentParam:e,oUPlayer:this.oUPlayer,callbacks:{onDataRequest:e=>{this.callbacks.onDataRequest(e)},onVastTagLoaded:e=>{},onDataSuccess:e=>{},onStart:e=>{this.impressionsCount++,this.callbacks.onStart(e)},onEmpty:()=>{this._destroyAds(),this._checkQueue()},onEnd:e=>{this._destroyAds(),this._checkQueue()},onTimeout:()=>{this._destroyAds(),this._checkQueue()},onError:e=>{this._destroyAds(),e.action="Проверяем дальше рекламную очередь",this.callbacks.onError(e),this._checkQueue()},onClick:e=>{this.callbacks.onClick(e)}}})):(this.callbacks.onCheckedQueue(),this.callbacks.onEnd())}}_destroyAds(){this.Ads&&(this.Ads.destroy(),delete this.Ads)}destroy(){this._destroyAds(),this._reset()}}({adsParam:this.param.ads.timeLine.preroll,oUPlayer:this,callbacks:{onCheckedQueue:e=>{},onDataRequest:e=>{this.callbacks.ads.onDataRequest(e)},onVastTagLoaded:e=>{this._sendStatNEW(e,"extOnVastLoadAll")},onDataSuccess:e=>{},onStart:e=>{this.wrapper.classList.remove("js-loading"),this.wrapper.classList.add("js-active","js-active-adv")},onEmpty:()=>{this._runVideo()},onEnd:()=>{this.callbacks.ads.onEnd(),this._runVideo()},onClick:e=>{this.callbacks.ads.onClick(e)},onError:e=>{console.log("ads onError",e)}}})),this.AdsManager.run()}_runVideo(){this._sendStat(""),this.wrapper.classList.remove("js-active","js-active-adv","js-loading"),this.wrapper.classList.add("js-active","js-active-video"),this.VideoManager||(this.VideoManager=new class{constructor(e){this._declare(e)}run(e){this._checkQueue()}_declare(e){this.param=e,this.oUPlayer=this.param.oUPlayer,this.callbacks=this.param.callbacks,this.queue=this._orderQueue(),this.Video=void 0,this.isInit=!0,this.totalImpressions=1,this.impressionsCount=0,this.queueInd=-1}destroy(){this.Video&&(this.Video.destroy(),this.Video=void 0),this._reset()}_reset(){this.totalImpressions=1,this.impressionsCount=0,this.queueInd=-1}_orderQueue(){const e=this.oUPlayer.param;if(e.video)return e.video;let t={};for(let a in e)"ads"!==a&&(t[a]=e[a]);return t=[t],t}_checkQueue(e){if(this.totalImpressions===this.impressionsCount)this.callbacks.onEnd(e);else{this.queueInd++;const t=this.queue[this.queueInd];t?this.Video=new u({videoParam:t,oUPlayer:this.oUPlayer,callbacks:{onStart:e=>{this.impressionsCount++,this.callbacks.onStart(e)},onEnd:e=>{this.Video.destroy(),delete this.Video,this._checkQueue(e)}}}):this.callbacks.onEnd(e)}}}({oUPlayer:this,callbacks:{onEnd:e=>{this.stop(e)},onStart:e=>{this.callbacks.video.onStart(e)}}})),this.VideoManager.run()}_onFullscreen(e){this._sendEventMessage("fullscreenOn")}_onFullscreenExit(e){this._sendEventMessage("fullscreenOff")}_sendEventMessage(e){try{window.top.postMessage(JSON.stringify({uPLayer:!0,event:e}),"*")}catch(e){}}_sendStat(e){}_sendStatNEW(e,t){if(e){"string"==typeof e&&(e=[e]);for(var a=0,s=e.length;a<s;a++){var i=e[a],r=document.createElement("IMG");r.src=i,r.style.cssText="visibility:hidden;position:absolute;left:-9999px;top:-9999px;display:block;width:1px;height:1px;overflow:hidden;",r.setAttribute("data-stat",t),document.body.appendChild(r)}}}abort(){this.stop(),this.oHTMLPlayer?this.oHTMLPlayer.abort():this.oYoutubePlayer&&this.oYoutubePlayer.abort()}destroy(){this.AdsManager&&(this.AdsManager.destroy(),this.AdsManager=void 0),this.VideoManager&&(this.VideoManager.destroy(),this.VideoManager=void 0),this.wrapper.className=this.wrapper.className.replace(/ js-active(-video|-adv)*/g,""),this.wrapper.innerHTML="",delete videoPlayer.all[this.name]}};!function(e,t){if(e.videoPlayer&&"function"==typeof e.videoPlayer)return!1;var a=function(e,t){const i="string"==typeof e?document.getElementById(e):e;return t.name||(t.name="player-"+String(Math.random()).slice(-6)),a.all[t.name]||(a.all[t.name]=new p(i,s,t)),a.all[t.name]};a.settings={vendors:{YaSDK:"//yandex.ru/ads/system/adsdk.js",IMASDK:"//imasdk.googleapis.com/js/sdkloader/ima3.js",youtube:"//www.youtube.com/iframe_api"}},a.all={},a.abortAll=function(e){for(var t in a.all){var s=a.all[t];e!==s&&s.abort()}},a.destroy=function(e){a.all[e].destroy},a.isMobile=function(){try{return APP.vars.isMobile}catch(e){return!1}}(),a.mobileAgent=function(){const e=["ipod","iphone","ipad","android","blackberry"];let t=0;for(;t<e.length;t++)if(new RegExp(e[t],"i").test(navigator.userAgent))return e[t];return!1}();const s={videoTag:void 0,isVideoInitialized:!1,isMuted:!0};s.videoTag=function(){let e=document.createElement("video");return e.style.cssText="visibility:hidden; position:absolute; left: -9999px; top: -9999px; width:1px; height:1px; overflow:hidden;",e.setAttribute("playsinline",""),e.setAttribute("muted",""),e}(),window.addEventListener("click",(function(){!function(){const e=s.videoTag;let t;if(localStorage&&localStorage.videoMuted)try{"on"===localStorage.videoMuted||(e.removeAttribute("muted"),t=!1)}catch(a){e.removeAttribute("muted"),t=!1}else e.removeAttribute("muted"),t=!1;document.body.appendChild(e),e.load(),s.isVideoInitialized=!0,s.isUserMuted=t}()}),{capture:!0,once:!0}),e.videoPlayer=a}(window,document)}])},820:(e,t,a)=>{"use strict";a.d(t,{B:()=>i});var s=a(848);const i={modules:{},run:function(e,t,a){e=e||document;var i={},r=(t=t||"data-modules",e.querySelectorAll("["+t+"]"));const o=t.replace("-","");return this.modules[o]||(this.modules[o]={}),r.forEach((e=>{let r=[];const o=e.getAttribute(t);try{r=JSON.parse(o),"length"in r||(r=[r])}catch(e){o.split(" ").forEach((e=>{e&&r.push({name:e})}))}r.forEach((t=>{const r=APP.settings[t.name];if(r)for(let e in r)r.hasOwnProperty(e)&&(e in t||(t[e]=r[e]));i[t.name]||(i[t.name]=[]);const o=!!a&&("object"==typeof a?a:a(t));i[t.name].push(new s.z(e,t,o))}))})),i},import:async function(e){const t=e.split("/").pop();return e="./"+e+".js?"+(APP.settings[t]?.ver||1),(await import(e))[t]},destroy:function(e){for(var t in e)e[t].forEach((function(e){e.destroy()}))}}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var a=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](a,a.exports,__webpack_require__),a.exports}__webpack_require__.d=(e,t)=>{for(var a in t)__webpack_require__.o(t,a)&&!__webpack_require__.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{"use strict";var e={};__webpack_require__.r(e),__webpack_require__.d(e,{Fav:()=>b,MyPlayer:()=>P,SubContent:()=>_,Trailer:()=>w,adfoxFullscreen:()=>v,aside:()=>r,astraone:()=>f,banner:()=>d,complete:()=>i,cookie:()=>k,dynamicPage:()=>y,helpers:()=>l,inImage:()=>g,manager:()=>t.B,newHeader:()=>u,oEmbed:()=>A,page:()=>m,picture:()=>h,ready:()=>s,sendAnalytics:()=>S,settings:()=>a,topAds:()=>c});var t=__webpack_require__(820);let a;if(APP.vars&&APP.vars.isDev){const e=Date.now();a={oEmbed:{path:"/oembed/[name]/"},Embed:{eName:"click"},uPopup:{},testFunction:{eName:"click"},TestClass:{},banner:{eName:"auto",options:{rootMargin:"50%"}},picture:{eName:"observe"},newMSearch:{},searchForm:{},SelectionForm:{eName:"focus"},burger:{eName:"click",preloader:!0,path:"111111111"},authNav:{eName:"click"},popover:{eName:"click"},progressList:{eName:"observe"},anchorMenu:{eName:"observe"},pageBtn:{eName:"click"},TrailerPlayer:{eName:"click"},page:{list:{auth:{path:"/frontend/popups/auth/",cls:"popup-narrow"},"reg-email":{path:"/frontend/popups/reg-email/",cls:"popup-narrow"},"auth-email":{path:"/frontend/popups/auth-email/",cls:"popup-narrow"},recover:{path:"/frontend/popups/recover/",cls:"popup-narrow"},avatar:{path:"/frontend/popups/avatar/",cls:"avatarPopup popup-middle"},merge:{path:"/frontend/popups/merge/",cls:"popup-middle",customClose:!0},"change-email":{path:"/frontend/popups/change-email/",cls:"popup-middle"},"change-password":{path:"/frontend/popups/change-password/",cls:"popup-middle"},reg:{path:"/frontend/popups/reg/"},"reg-kk":{path:"/frontend/popups/reg-kk/",cls:"popup-middle popup-shrink"},"reg-preview":{path:"/frontend/popups/reg-preview/",cls:"previewRegistration popup-middle popup-shrink"},"auth-old":{path:"/frontend/popups/auth-old/"},"auth-kk":{path:"/frontend/popups/auth-kk/",cls:"popup-middle popup-shrink"},"auth-new":{path:"/frontend/popups/auth-new/",cls:"popup-rounded",customClose:!0},"auth-simple":{path:"/frontend/popups/auth-simple/",cls:"popup-middle popup-shrink"},"invite-kk":{path:"/frontend/popups/invite-kk/",cls:"popup-middle popup-shrink"},"recover-old":{path:"/frontend/popups/recover-old/"},support:{path:"/frontend/popups/support/"},howFav:{path:"111"},mistake:{path:"/service/popup/mistake/"},newMail:{path:"/service/popup/newmail/"},subscribe:{path:"/service/popup/subscribe/"},allcafe:{path:"/service/popup/allcafe/?cinema=[CINEMAID]"},watch:{path:"/frontend/popups/watch/[trailerId]/"+(APP.vars.lang&&"ru"!==APP.vars.lang?APP.vars.lang+"/":""),cls:"watchPopup watchPopup-indent",customClose:!0},"random-film":{path:"/frontend/popups/random-film/",cls:"randomFilmPopup"}}},newCity:{eName:"click"},aside:{},xhrForm:{},YaShare2:{eName:"observe"},thumbGallery:{eName:"observe"},slider:{eName:"observe"},fullscreenGallery:{eName:"observe"},poll:{eName:"observe"},Comments:{},CommentsForm:{path:"/frontend/commentsForm/[sectionName]/[sectionId]/addcomment/"},CommentsItem:{},dynamicPage:{eName:"auto"},dynamicIframe:{eName:"observe"},Vote:{eName:"click",path:{commentsLike:"/frontend/vote/commentsLike/[sectionName]/[sectionId]/votecomment/",movie:"/frontend/vote/movie/[movieId]/come/",online:"/frontend/vote/movie/[movieId]/watch/",video:"/frontend/vote/video/[movieId]/video/[videoId]/vote"}},Fav:{path:{common:"/frontend/fav/[type]/[uid]/fav/"}},Watched:{path:{common:"/frontend/watched/[type]/[uid]/watched/"}},Rating:{eName:"observe",path:{common:"/frontend/rating/[type]/[uid]/vote/"}},adfoxFullscreen:{},load:{},sortList:{eName:"click"},astraone:{},MyPlayer:{},show:{eName:"click"},toggle:{eName:"click"},Schedule:{eName:"observe"},ScheduleSearch:{eName:"click"},ScheduleNewSearch:{eName:"click"},DropList:{eName:"click"},Watch:{},ToBuy:{eName:"click"},SubContent:{},showSubContent:{eName:"click",prevent:!0},DropRating:{eName:"click"},Accordion:{},More:{eName:"observe"},nearFilter:{eName:"observe"},MySwiper:{eName:"observe"},MySwiper3:{eName:"observe"},LazyEmbed:{eName:"observe"},SectionMenu:{eName:"observe"},multiRange:{eName:"observe"},TheatersMap:{eName:"observe"},AjaxContent:{eName:"observe"},DatePicker:{eName:"observe"},SymbolSort:{eName:"observe"},soundtrackList:{eName:"click"},Avatar:{eName:"click"},FilterOnline:{eName:"observe"},showPopup:{},SearchCity:{eName:"click"},onboarding:{eName:"auto"},onboardingAfterReg:{eName:"auto"},myNewsWidget:{eName:"observe"},Tabs:{eName:"observe"},CountDown:{eName:"observe"},pwd:{eName:"click"},bookingPreviewsList:{},AjaxFilter:{},AjaxMore:{eName:"click"},FilmSlider:{},FilmSlider2:{},cookieOverlay:{eName:"click"},Tip:{},randomFilmWidget:{eName:"observe"},selectModule:{},ConjuringMovie:{eName:"observe"},Notice:{}};for(let t in a)a[t].ver=e}else a={oEmbed:{ver:4,path:"/service/oembed/[name]/"},Embed:{ver:3,eName:"click"},uPopup:{ver:3},testFunction:{ver:1,eName:"click"},TestClass:{ver:1},banner:{ver:6,eName:"observe",options:{rootMargin:"50%"}},picture:{ver:1,eName:"observe"},newMSearch:{ver:5},searchForm:{ver:3},SelectionForm:{eName:"focus",ver:4},burger:{ver:8,eName:"click",preloader:!0,path:"111111111"},authNav:{ver:2,eName:"click"},popover:{ver:1,eName:"click"},progressList:{ver:6,eName:"observe"},anchorMenu:{ver:1,eName:"observe"},pageBtn:{ver:3,eName:"click"},TrailerPlayer:{ver:7,eName:"click"},page:{ver:15,list:{auth:{path:"/"+APP.vars.lang+"/service/popups/auth/",cls:"popup-narrow"},"auth-email":{path:"/"+APP.vars.lang+"/service/popups/authemail/",cls:"popup-narrow"},reg:{path:"/"+APP.vars.lang+"/service/popups/register/",cls:"popup-narrow"},recover:{path:"/"+APP.vars.lang+"/service/popups/recovery/",cls:"popup-narrow"},merge:{path:"/"+APP.vars.lang+"/service/popups/merge/",cls:"popup-middle",customClose:!0},howfav:{path:"/"+APP.vars.lang+"/service/popups/howfav/",cls:"popup-narrow"},"change-email":{path:"/"+APP.vars.lang+"/service/popups/newmail/",cls:"popup-middle"},"change-password":{path:"/profile/changepassword/",cls:"popup-middle"},club:{path:"/"+APP.vars.lang+"/service/popups/clubjoin/",cls:"popup-narrow"},support:{path:"11111111111"},mistake:{path:"/"+APP.vars.lang+"/service/popup/mistake/"},newMail:{path:"/"+APP.vars.lang+"/service/popup/newmail/"},changePwd:{path:"/"+APP.vars.lang+"/service/popup/changepwd/"},subscribe:{path:"/"+APP.vars.lang+"/service/popup/subscribe/"},allcafe:{path:"/"+APP.vars.lang+"/service/popup/allcafe/?cinema=[CINEMAID]"},watch:{path:"/"+APP.vars.lang+"/service/popups/watch/[trailerId]/",cls:"watchPopup watchPopup-indent",customClose:!0},"random-film":{path:"/"+APP.vars.lang+"/service/popups/moviessuggest/",cls:"randomFilmPopup"}}},newCity:{ver:2,eName:"click"},aside:{ver:3},xhrForm:{ver:12},YaShare2:{ver:3,eName:"observe"},thumbGallery:{ver:3,eName:"observe"},slider:{ver:5,eName:"observe"},fullscreenGallery:{ver:10,eName:"observe"},poll:{ver:7,eName:"observe"},Comments:{ver:6},CommentsForm:{ver:17,path:"/[sectionName]/[sectionId]/addcomment/"},CommentsItem:{ver:5},dynamicPage:{ver:13,eName:"auto"},dynamicIframe:{ver:2,eName:"observe"},Vote:{ver:15,eName:"click",path:{commentsLike:"/[sectionName]/[sectionId]/votecomment/",movie:"/movies/[movieId]/come/",online:"/movies/[movieId]/watch/",video:"/movies/[movieId]/video/[videoId]/vote"}},Fav:{ver:16,path:{common:"/[type]/[uid]/fav/"}},Watched:{ver:14,path:{common:"/[type]/[uid]/watched/"}},Rating:{ver:15,eName:"observe",path:{common:"/[type]/[uid]/vote/"}},adfoxFullscreen:{ver:23},load:{ver:6},sortList:{ver:2,eName:"click"},astraone:{ver:7},MyPlayer:{ver:26},show:{ver:1,eName:"click"},toggle:{ver:3,eName:"click"},Schedule:{ver:1,eName:"observe"},ScheduleSearch:{ver:2,eName:"click"},ScheduleNewSearch:{ver:5,eName:"click"},DropList:{ver:7,eName:"click"},Watch:{ver:11},ToBuy:{eName:"click",ver:43},SubContent:{ver:17},showSubContent:{ver:4,eName:"click",prevent:!0},DropRating:{ver:3,eName:"click"},Accordion:{ver:8},More:{ver:9,eName:"observe"},nearFilter:{ver:1,eName:"observe"},MySwiper:{ver:32,eName:"observe"},MySwiper3:{ver:4,eName:"observe"},LazyEmbed:{ver:4,eName:"observe"},SectionMenu:{ver:1,eName:"observe"},multiRange:{ver:1,eName:"observe"},TheatersMap:{ver:5,eName:"observe"},TheaterMap:{ver:2},AjaxContent:{ver:2,eName:"observe"},DatePicker:{ver:1,eName:"observe"},SymbolSort:{ver:2,eName:"observe"},soundtrackList:{ver:3,eName:"click"},Avatar:{ver:3,eName:"click"},FilterOnline:{ver:1,eName:"observe"},showPopup:{ver:7},SearchCity:{ver:5,eName:"click"},onboarding:{ver:12},onboardingAfterReg:{ver:4},myNewsWidget:{ver:23,eName:"observe"},Tabs:{ver:5,eName:"observe"},CountDown:{ver:2,eName:"observe"},pwd:{eName:"click"},bookingPreviewsList:{ver:2},AjaxFilter:{ver:5},selectModule:{ver:5},AjaxMore:{ver:2,eName:"click"},FilmSlider:{ver:4},FilmSlider2:{ver:1},cookieOverlay:{ver:7,eName:"click"},Tip:{ver:2},randomFilmWidget:{ver:6.3,eName:"observe"},ConjuringMovie:{ver:3,eName:"observe"},Notice:{ver:6}};var s=function(e){var t,a=function(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",s,!1),window.removeEventListener("load",s,!1)):(document.detachEvent("onreadystatechange",s),window.detachEvent("onload",s))},s=function(){(document.addEventListener||"load"===event.type||"complete"===document.readyState)&&(a(),i())},i=function(){t||(t=!0,e())};if("complete"===document.readyState)setTimeout(i);else if(document.addEventListener)document.addEventListener("DOMContentLoaded",s,!1),window.addEventListener("load",s,!1);else{document.attachEvent("onreadystatechange",s),window.attachEvent("onload",s);var r=!1;try{r=null==window.frameElement&&document.documentElement}catch(e){}r&&r.doScroll&&function e(){if(!t){try{r.doScroll("left")}catch(t){return setTimeout(e,50)}a(),i()}}()}};const i=function(e){"complete"!==document.readyState?window.addEventListener("load",e):e()};function r(e){if(APP.vars.mobileAgent)return;let t="up",a=0;const s=e.querySelector("[data-aside-sticky]");let i=!1;const r=function(){i||(i=!0,window.addEventListener("scroll",n))};let o;APP.manager.run(e,"data-aside-modules",(e=>{if("banner"===e.name&&s)return{callbacks:{onError:r,onStub:r,onRender:void(o=setTimeout((()=>{r()}),4e4))}}}));const n=function(){window.pageYOffset<a&&"down"==t?l():window.pageYOffset>a&&"up"==t&&d(),a=window.pageYOffset},l=function(){const a=e.getBoundingClientRect().bottom-s.getBoundingClientRect().bottom;e.classList.remove("js-bottom"),s.style.cssText="margin:0 0 "+a+"px",t="up"},d=function(){const a=s.getBoundingClientRect().top-e.getBoundingClientRect().top;e.classList.add("js-bottom"),s.style.cssText="margin:"+a+"px 0 0",t="down"};(window.advertronic=window.advertronic||{cmd:[]}).cmd.push((e=>{const t=function(a){const s=a.args.state,i=a.args.slot;"empty"===s&&(r(),e.watchSlotStateCancel(i,t))};e.watchSlotState('[data-name="ka_d_all_side1"]',t)}))}class o{constructor(e){this.byDefault={btnConfirm:"Ок",btnCancel:"Отмена"},this.create(e),this._add(e)}_add(e){this.name=this.param.name||"popup-"+(new Date).getTime(),"string"==typeof e?this.content.innerHTML=e:"string"==typeof e.content?this.content.innerHTML=e.content:"object"==typeof e.content&&(this.popupInner=e.content,this.content.appendChild(e.content)),e.title?(this.title.innerHTML=e.title,this.title.style.display="block"):(this.title.innerHTML="",this.title.style.display="none"),this.isShowBtn(e.btnConfirm,"btnConfirm"),this.isShowBtn(e.btnCancel,"btnCancel"),(e.btnConfirm||e.btnCancel)&&(this.table.className=this.table.className+" popup-controls"),this.showX(e,this.btnCloseAll),this._addCustomClose()}_addCustomClose(){if(!this.param.customClose)return;const e=this.content.querySelectorAll('[data-js="close"]');this.showX(!1,e)}showX(e,t){for(var a=this,s=0,i=t.length;s<i;s++)t[s].addEventListener("click",(function(e){e.preventDefault(),a.close.call(a)}));e.autoClose&&this.runTimer(e)}isShowBtn(e,t){var a=this;if(e){if("boolean"==typeof e?(this[t].innerHTML=this.byDefault[t],this[t].onclick=function(e){return(e=e||window.event).preventDefault?e.preventDefault():e.returnValue=!1,a.close.call(a),!1}):"string"==typeof e?(this[t].innerHTML=e,this[t].onclick=function(e){return(e=e||window.event).preventDefault?e.preventDefault():e.returnValue=!1,a.close.call(a),!1}):(this[t].innerHTML=e.name||this.byDefault[t],this[t].onclick=function(t){return(t=t||window.event).preventDefault?t.preventDefault():t.returnValue=!1,null==e.callback?a.close.call(a):e.callback()||a.close.call(a),!1}),e.className)var s=this[t].defaultClass+" "+e.className;else s=this[t].defaultClass;this[t].className=s,this[t].className=this[t].className.replace(/ disabled/,"")}else this[t].className=this[t].className.replace(/ disabled/,"")+" disabled"}create(e){this.param=e;var t="popup "+(this.param.addClass||"");this.disabled=!1,this.countdownInterval=!1,this.clearOpen=!1,this.clearClose=!1,this.mainFrame=document.getElementById("main-frame"),this.table=document.createElement("DIV"),this.table.className=t,e.autoClose?this.table.innerHTML='<div class="popup_frame"><div class="popup_cell"><div data-js="close" class="popup_bg"></div><div class="popup_container"><a data-js="close" class="popup_close popup_progress" href="#"><div class="popup_layer"></div><div class="popup_info"><span class="popup_info_text">Реклама скроется через</span><div class="popup_info_countdown"></div><div class="popup_info_close as-none js-deactivate"></div></div></a><span class="popup_title">\x3c!-- Заголовок --\x3e</span><div class="popup_content">\x3c!-- Содержимое --\x3e</div><div class="popup_btns"><a href="#" class="popup_confirm popup_btn disabled">'+this.byDefault.btnConfirm+'</a><a href="#" class="popup_cancel popup_btn disabled">'+this.byDefault.btnCancel+"</a></div></div></div></div>":this.table.innerHTML='<div class="popup_frame"><div class="popup_cell"><div data-js="close" class="popup_bg"></div><div class="popup_container layer-default"><a data-js="close" class="popup_close" href="#"><svg class="popup_closeBtn symbol symbol-x" role="img"><use xlink:href="#close"></use></svg></a><span class="popup_title">\x3c!-- Заголовок --\x3e</span><div class="popup_content">\x3c!-- Содержимое --\x3e</div><div class="popup_btns"><a href="#" class="popup_confirm popup_btn disabled">'+this.byDefault.btnConfirm+'</a><a href="#" class="popup_cancel popup_btn disabled">'+this.byDefault.btnCancel+"</a></div></div></div></div>",document.body.appendChild(this.table),this.container=this.table.querySelector(".popup_container"),this.title=this.table.querySelector(".popup_title"),this.content=this.table.querySelector(".popup_content"),this.btnConfirm=this.table.querySelector(".popup_confirm"),this.btnConfirm.defaultClass=this.btnConfirm.className,this.btnCancel=this.table.querySelector(".popup_cancel"),this.btnCancel.defaultClass=this.btnCancel.className,this.btnCloseAll=this.table.querySelectorAll('[data-js="close"]'),this.scrollWidth=window.innerWidth-document.body.clientWidth}open(){if(this.disabled||this.clearOpen)return!1;try{clearTimeout(this.clearClose)}catch(e){}if(this.param.onopenBefore&&!this.param.onopenBefore())return!1;var e=this;0===n.count&&n.lock.on(),this.table.className=this.table.className.replace(/\s*active/,"")+" active",n.count+=1,this.clearOpen=setTimeout((function(){e.param.onopen&&e.param.onopen(e.content),e.clearOpen=!1}),0)}close(){if(this.disabled||this.clearClose)return!1;try{clearTimeout(this.clearOpen),clearInterval(this.countdownInterval)}catch(e){console.error(e)}if(this.clearClose=!0,this.param.oncloseBefore&&!this.param.oncloseBefore())return this.clearClose=!1,!1;var e=this;this.table.className=this.table.className.replace(/\s*active/,""),this.clearClose=setTimeout((function(){e._removeCustomClose(),document.body.removeChild(e.table);try{document.body.appendChild(e.popupInner)}catch(e){}e.param.onclose&&e.param.onclose(),e.clearClose=!1,1===n.count&&n.lock.off(),n.count-=1,delete n.all[e.param.name]}),0)}_removeCustomClose(){}runTimer(e){var t,a,s,i,r;r=e.autoClose/1e3,t=document.querySelector(".popup_progress"),a=t.querySelector(".popup_info_countdown");let o=t.querySelector(".popup_info_close");a.textContent=r,s=t.querySelector(".popup_layer"),i=e.autoClose/1e3,this.countdownInterval=setInterval((()=>{r=--r<=0?0:r,a.textContent=r,i-2>=r&&o.classList.remove("as-none"),r<=0&&this.close.call(this)}),900),s.style.transition=`width ${r}s`,s.style.width="100%"}}const n=function(e){return e.name||(e.name="popup-"+(new Date).getTime()),n.all[e.name]||(n.all[e.name]=new o(e)),n.all[e.name].open(),n.all[e.name]};n.count=0,n.all={},n.lock=new class{constructor(){this.status=null}_declare(){this.siteTag=document.getElementById("site"),this.IOS=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),this.media=window.matchMedia("(max-width: 758px)")}on(){"on"!==this.status&&(null===this.status&&this._declare(),this.status="on",this.mobileVersion=this.media.matches,this.fixedLock=this.mobileVersion||this.IOS,this.fixedLock?(this.offset=window.pageYOffset,this.siteTag.style.marginTop=-this.offset+"px",document.body.classList.add("body-fixedLock")):(this.scrollWidth=window.innerWidth-document.body.clientWidth,document.body.style.paddingRight=this.scrollWidth+"px",document.body.classList.add("body-lock")))}off(){"off"!==this.status&&(this.status="off",this.fixedLock?(this.siteTag.style.marginTop="0px",document.body.classList.remove("body-fixedLock"),window.scrollTo(0,this.offset)):(document.body.style.paddingRight="0px",document.body.classList.remove("body-lock")))}},n.closeAll=function(){for(var e in n.all)n.all[e].close()},window.uPopup||(window.uPopup=n);var l={scriptonload:function(e,t){"string"==typeof e&&(e=[e]);var a=e.length,s=0,i=function(){++s===a&&t&&t()},r=function(e){this.addEventListener?(this.removeEventListener("load",r,!1),this.isLoading=!1,i()):"complete"!=this.readyState&&"loaded"!=this.readyState||(this.detachEvent("onreadystatechange",e),this.isLoading=!1,i())},o=function(e){e.addEventListener?e.addEventListener("load",r,!1):e.attachEvent("onreadystatechange",(function t(){r.call(e,t)}))};if(function(e){for(var t=e.length,a={},s=!1,i=0;i<t;i++)s=s||a.hasOwnProperty(e[i]),a[e[i]]=e[i];return!s}(e))for(var n=0;n<a;n++){var l="scriptonload-"+e[n].replace(/[^A-Za-z0-9]/g,"_"),d=document.scripts[l];d?d.isLoading?o(d):i():((d=document.createElement("script")).setAttribute("async",!1),d.setAttribute("src",e[n]),d.setAttribute("id",l),d.isLoading=!0,o(d),document.body.appendChild(d))}else{var c="scriptonload.js: Scripts are not unique!";try{console.error(c)}catch(e){alert(c)}}},throttle:function(e,t,a){a=a||window;var s=!1,i=function(){s||(s=!0,requestAnimationFrame((function(){t(),s=!1})))};return a.addEventListener(e,i),{tag:a,eName:e,func:i}},checkVisibility:function(e){var t=e.box,a=e.progressEl||!1,s=e.callback||!1,i=!1,r=e.time||3e4,o=0,n=0,l=function(){document.hidden?c():d()},d=function(){if(h=(l=t.getBoundingClientRect()).top+l.height/2,u=l.left+l.width/2,h>0&&u>0&&h<(window.innerHeight||document.documentElement.clientHeight)&&u<(window.innerWidth||document.documentElement.clientWidth)){if(!i){n=Date.now();var e=r-o;try{a.style.cssText="width:100%;transition-duration:"+e+"ms"}catch(e){}i=setTimeout((function(){s(),o=0;try{a.style.cssText="width:0%;transition-duration:0ms"}catch(e){}i=!1,d()}),e)}}else c();var l,h,u},c=function(){if(i){clearTimeout(i),i=!1,o+=Date.now()-n;try{a.style.cssText="width:"+o/r*100+"%;transition-duration:0ms"}catch(e){}}},h=function(){APP.bases.helpers.throttle("scroll",d),APP.bases.helpers.throttle("resize",d),document.addEventListener("visibilityChange",l,!1),document.hidden||d()};"complete"===document.readyState?h():window.addEventListener("load",h)},addCss:function(e){if(!e||""===e||e.length)return;APP.cssList=APP.cssList||[];let t="";for(let a in e)-1===APP.cssList.indexOf(a)&&(t+=e[a],APP.cssList.push(a));if(!t.length)return;const a=document.createElement("STYLE");a.append(t),document.head.append(a)},XHR:class{constructor(e="",t={}){this.data=t,this.url=e,this.controller=new AbortController,this.data.signal=this.controller.signal,this.data.method=t.method||"POST",this.pending=!1,this._setHeaders()}_setHeaders(){const e=window.location.toString();this.data.headers=this.data.headers||{},this.data.headers["X-Request-Ajax"]=1,this.data.headers["X-Request-Referer"]=-1!==e.lastIndexOf("#")?e.substring(e.lastIndexOf("#"),0):e,this.data.headers["x-request-css"]=APP.cssList.join(";")}async send(e={}){let t,a;if(e instanceof FormData)t=e;else if(e instanceof HTMLFormElement)t=new FormData(e);else{t=new FormData;for(let a in e)e.hasOwnProperty(a)&&t.append(a,e[a])}this.data.body=t,this.pending=!0;try{a=await fetch(this.url,this.data),a=await a.json()}catch(e){a=!1}return this.pending=!1,this.importedModule=!1,a}abort(e){this.pending&&(this.importedModule=e,this.controller.abort(),this.pending=!1)}},randomInteger:function(e,t){var a=e-.5+Math.random()*(t-e+1);return Math.round(a)},decline:function(e,t){return t[e%100>4&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]},checkAuth:function(e){return!!APP.vars.isUserAuth||(e&&e.preventDefault(),window.location.hash="#!auth",!1)},getMobileAgent:function(){for(var e=["ipod","iphone","ipad","android","blackberry"],t=0;t<e.length;t++)if(new RegExp(e[t],"i").test(navigator.userAgent))return{name:e[t],system:t<3?"ios":3===t?"android":"blackberry"};return!1},checkAdBlock:function(){const e=document.createElement("DIV");return e.classList.add("px"),e.setAttribute("id","adblock"),document.body.appendChild(e),!e.getBoundingClientRect().width},addPx:function(e,t="",a=""){const s=document.createElement("IMG"),i=(new Date).getTime();let r=e.replace(/\[RANDOM\]/,i);s.setAttribute("class","px "+a),s.setAttribute("src",r),s.setAttribute("alt",t),document.body.appendChild(s)}};const d=function(e,t,a,s={}){let i=e.dataset.param;i=i?JSON.parse(i):{},i.system=i.system?i.system:"adfox";const r=!!e.dataset.lazy&&JSON.parse(e.dataset.lazy);let o=!1;const n=r?r[0].containerId:void 0;let l,d=!1,c=!1;const h=function(){try{return JSON.parse(e.dataset.bidders)}catch(e){return!1}}(),u=e=>{d="load",console.log("banner  onLoad",n),c||b()},p=()=>{d="render",console.log("banner  onRender",n),console.log("param",i),e.classList.add("js-render"),e.classList.contains("topAds")&&v(),"sticker"===i.view&&m();try{s.callbacks.onRender()}catch(e){}},m=function(){const e=function(){var e=document.getElementById("bigBanner");e.parentNode.removeChild(e)};if(APP.vars.hideBottomStickyBanner)e();else{const t=document.getElementById("stickyClose");t.style.display="unset",t.addEventListener("click",e)}},v=function(){if(!APP.vars.topAdsMobileSticking||!APP.vars.mobileAgent)return;const t=1e3*APP.vars.topAdsMobileSticking,a=function(){setTimeout((()=>{e.classList.remove("el-sticky")}),t)};"complete"===document.readyState?a():window.addEventListener("load",a),e.classList.add("el-sticky")},y=function(e){if(d="error",console.log("banner  onError uid",n),console.log("banner  onError err",e),i.alt)g();else{_();try{s.callbacks.onError()}catch(e){}}},f=function(e){if(d="stub",console.log("banner  onStub uid",n),console.log("banner  onStub err",e),i.alt)g();else{_();try{s.callbacks.onStub()}catch(e){}}},g=function(){const t=i.pid;try{APP.bases.ready((function(){e.setAttribute("id","_mt_ot_container_"+t),e.innerHTML="",_MT_jsLoadDelayed("//static.kinoafisha.info/external/otclick-adv.ru/core/code.js",void 0,void 0,t)}))}catch(e){}},b=function(){if(c=!0,i.reload){var t=e.querySelector("[data-ads-progress]"),a={box:e,time:1e3*i.reload.time||3e4,progressEl:t||!1,callback:function(){o||window.Ya.adfoxCode.reload(n)}};APP.bases.helpers.checkVisibility(a)}},_=function(){console.log("banner","will destroy "+n);try{window.Ya.adfoxCode.destroy(n)}catch(e){}try{clearTimeout(l)}catch(e){}if(e.classList.contains("ads-fix"))try{e.innerHTML=""}catch(e){}else try{e.parentElement.removeChild(e)}catch(e){}"sticker"===i.view&&(document.getElementById("stickyClose").style.display="none"),o=!0},P={destroy:_};if(i.alt&&APP.vars.isAdBlock)g();else if("adfox"===i.system){if(!r)return void console.warn("lazy params destroy in banner module");r[0].onLoad=u,r[0].onRender=p,r[0].onError=y,r[0].onStub=f,r[0].params||(r[0].params={}),r[0].params.puid5=innerWidth>=1921?2560:innerWidth>=1280?1920:innerWidth>=759?1280:640,h&&(window.Ya&&window.Ya.headerBidding?window.Ya.headerBidding.pushAdUnits(h):window.YaHeaderBiddingSettings.adUnits.push(h));const e=function(){window.yaContextCb.push((()=>{Ya.adfoxCode.createAdaptive(r[0],r[1],r[2]),l=setTimeout((function(){d||i.reload||o||_()}),2e3)}))};if("sticker"===i.view){const t=function(){pageYOffset>100&&(a.tag.removeEventListener(a.eName,a.func),e())},a=APP.bases.helpers.throttle("scroll",t);t()}else e()}else i.system;return P},c=function(e,t,a,s={}){let i,r=!1;const o={destroy:function(){clearTimeout(i),window.removeEventListener("load",onLoad),e.classList.remove("el-sticky"),r=!0}};return(window.advertronic=window.advertronic||{cmd:[]}).cmd.push((t=>{t.watchBannersState('[data-name="ka_m_all_brand"]',(function(a){const s=a.args.banner.state;"loaded"!==s&&"error"!==s||t.watchBannersStateCancel(a),function(){if(!APP.vars.topAdsMobileSticking||!APP.vars.mobileAgent)return;const t=1e3*APP.vars.topAdsMobileSticking,a=function(){i=setTimeout((()=>{e.classList.remove("el-sticky")}),t)};"complete"===document.readyState?a():window.addEventListener("load",a),e.classList.add("el-sticky")}()}))})),o},h=function(e){const t=e.querySelector("template"),a=e.querySelector("[data-picture]"),s=JSON.parse(e.getAttribute("data-param"))||{};t&&(e.insertBefore(t.content,a),e.removeChild(t)),a&&(a.setAttribute("src",a.dataset.picture),a.removeAttribute("data-picture"),s.preloader&&a.addEventListener("load",(()=>{e.classList.add("js-loaded")})))};function u(e){let t,a,s="up";const i=e.parentNode.getBoundingClientRect().top-document.body.getBoundingClientRect().top+e.getBoundingClientRect().height,r=function(e){const t=e.target;if(t.hash&&-1===t.hash.indexOf("#!")&&t.pathname===location.pathname){const e=document.getElementById(t.hash.slice(1));n(e)}},o=function(){window.pageYOffset>i?e.classList.add("js-sticky"):e.classList.remove("js-sticky")},n=function(e){e&&(e.getBoundingClientRect().top<0?d():c())},l=function(){Math.abs(t-window.pageYOffset)<10||(window.pageYOffset<=t||window.pageYOffset<=i?d():c(),t=window.pageYOffset)},d=function(){"up"!=s&&(s="up",document.body.classList.remove("body-newHeader"))},c=function(){"down"!=s&&(s="down",document.body.classList.add("body-newHeader"))},h=function(){a=APP.bases.helpers.throttle("scroll",l)},u={on:h,off:function(){a.tag.removeEventListener(a.eName,a.func)},willScrollTo:n},p=function(){window.removeEventListener("wheel",p),window.removeEventListener("mousedown",p),window.removeEventListener("touchmove",p),t=pageYOffset,window.addEventListener("click",r),h()};APP.header||(APP.header=u,o(),APP.bases.helpers.throttle("scroll",o),performance&&performance.navigation&&performance.navigation.type==performance.navigation.TYPE_RELOAD&&sessionStorage&&1==sessionStorage.getItem("compactHeader")&&(location.hash&&navigator.vendor.match(/apple/i)||c()),window.addEventListener("wheel",p,{once:!0}),window.addEventListener("mousedown",p,{once:!0}),window.addEventListener("touchmove",p,{once:!0}),window.addEventListener("unload",(function(e){try{sessionStorage.setItem("compactHeader",+document.body.classList.contains("body-newHeader"))}catch(e){}})))}class p{constructor(e="",t={}){this.data=t,this.url=e,this.controller=new AbortController,this.data.signal=this.controller.signal,this.data.method=t.method||"POST",this.pending=!1,this._setHeaders()}_setHeaders(){const e=window.location.toString();this.data.headers=this.data.headers||{},this.data.headers["X-Request-Ajax"]=1,this.data.headers["X-Request-Referer"]=-1!==e.lastIndexOf("#")?e.substring(e.lastIndexOf("#"),0):e,this.data.headers["x-request-css"]=APP.cssList.join(";")}async send(e={}){let t,a;if(e instanceof FormData)t=e;else if(e instanceof HTMLFormElement)t=new FormData(e);else{t=new FormData;for(let a in e)e.hasOwnProperty(a)&&t.append(a,e[a])}this.data.body=t,this.pending=!0;try{a=await fetch(this.url,this.data),a=await a.json()}catch(e){a=!1}return this.pending=!1,this.importedModule=!1,a}abort(e){this.pending&&(this.importedModule=e,this.controller.abort(),this.pending=!1)}}const m=function(){const e=class{constructor(e,t,a={}){this.settings=e,this.name=t,this.param=a,this.path=this.getPath(),this.request=new p(this.path),this.changeHistory=!0,this.show()}getPath(){return this.settings.path.replace(/\[(.+?)\]/g,((e,t)=>this.param[t]))}handleEvent(e){e.preventDefault(),this.show()}async show(){const e=this.settings.cls?this.settings.cls:"popup-middle",t=this.param.customClose?this.param.customClose:!!this.settings.customClose&&this.settings.customClose;if(this.request.pending)return;const s=await this.request.send();s&&(s.status?(this._addCss(s.css),this.popup=uPopup({addClass:e,name:this.name,content:s.html,customClose:t,onopen:e=>{this._sendPageStat(),this.moduleAll=APP.manager.run(e,"data-popup-modules",(e=>{if("Watch"===e.name)return{callbacks:{closePopup:()=>this.popup.close()}}}))},oncloseBefore:()=>{if(this.changeHistory){var e=location.href.replace(/#!.*/,"");window.history.pushState({},"",e)}else this.changeHistory=!0;return APP.manager.destroy(this.moduleAll),a=void 0,!0}})):alert(s.message))}_addCss(e){APP.bases.helpers.addCss(e)}close(){this.changeHistory=!1,this.popup.close()}_sendPageStat(){const e="#!"+this.name;if("auth"===this.name)try{APP.bases.sendAnalytics("user_authorize_view")}catch(e){}try{APP.bases.sendAnalytics({type:"page",pagePath:e})}catch(e){}}addBtn(e){e.addEventListener("click",this),this.btnAll.push(e)}destroy(){console.log("/* TODO */")}};let t,a;const s=function(e){if(-1!==e.newURL.indexOf("#!")){let e=decodeURI(window.location.hash.replace("#!",""));e=function(){try{e=JSON.parse(e),r(e)}catch(t){i(e)}}()}else-1!==e.oldURL.indexOf("#!")&&o()},i=function(t){const s=APP.settings.page.list[t];let i=s,r={},o=APP.bases.page.currentData;if(o){if(o.settings){i=o.settings;for(let e in s)i.hasOwnProperty(e)||(i[e]=s[e])}r=APP.bases.page.currentData.param}o=void 0,APP.bases.page.currentData=void 0,a&&a.close(),a=new e(i,t,r)},r=function(s){const i=APP.settings.page.list[s.hash];let r=s.settings;const o=s.param||{};if(r)for(let e in i)r.hasOwnProperty(e)||(r[e]=i[e]);else r=i;t=void 0,APP.bases.page.currentData=void 0,a&&(console.log(a),a.close()),a=new e(r,s.hash,o)},o=function(){t=void 0,APP.bases.page.currentData=void 0,a=void 0,uPopup.closeAll()};return{init:function(){s({newURL:location.href,oldURL:""}),window.addEventListener("hashchange",s)},show:i,change:function(e){window.location.hash="#!"+e},currentData:t}}(),v=function(e){let t=JSON.parse(e.dataset.param),a=!1;const s=function(){try{return JSON.parse(e.dataset.bidders)}catch(e){return!1}}();t[0].onLoad=function(){},t[0].onRender=function(){if(!1===APP.vars.showAdfoxFullscreen)return;if(a)return;let t;a=!0,"#fullscreenTest"==location.hash?(console.log("APP.vars.showAdfoxFullscreen",APP.vars.showAdfoxFullscreen),console.log("wrapper",e),t=1e8):t=1e4,uPopup({addClass:"popup-adfox",name:"adfox",content:e,autoClose:t,oncloseBefore:function(){return window.Ya.adfoxCode.destroy(e.getAttribute("id")),!0}})},t[0].onError=function(t){e.parentNode.removeChild(e)},t[0].onStub=function(){e.parentNode.removeChild(e)},s&&(window.Ya&&window.Ya.headerBidding?window.Ya.headerBidding.pushAdUnits(s):window.YaHeaderBiddingSettings.adUnits.push(s)),window.yaContextCb.push((()=>{Ya.adfoxCode.createAdaptive(t[0],t[1],t[2])}))};var y=function(e){var t,a,s,i=[],r=0,o=!1,n=[],l=(a={},s=document.querySelector("head"),a.ogTitle=s.querySelector('meta[property="og:title"]'),a.ogUrl=s.querySelector('meta[property="og:url"]'),a),d=class{constructor(t){if(t){if(this.url=t.param.next,!this.url)return void y();(o=new XMLHttpRequest).open("POST",this.url,!0),o.setRequestHeader("X-Request-Ajax","1"),o.onload=()=>{this.onloadData()},o.send("")}else this.itemEl=e.querySelector("[data-dynamicPage-item]"),this.url=window.location.pathname+window.location.search,this.hideBlocks(),this.addModules()}onloadData(){const t=JSON.parse(o.responseText);if(t.status){var a=document.createElement("DIV"),s=!1;a.innerHTML=t.html,this.itemEl=a.firstElementChild,e.getBoundingClientRect().bottom<0&&(s=!0),this.hideBlocks(),e.appendChild(this.itemEl),s&&window.scrollBy(0,this.itemEl.getBoundingClientRect().top-46),this._addCss(t.css),this.addModules(),this.reloadScripts(),this.checkNextPage(),o=!1}}_addCss(e){APP.bases.helpers.addCss(e)}hideBlocks(){this.itemEl.querySelectorAll("[data-dynamicPage-hide]").forEach((function(e){e.style.display="none"}))}reloadScripts(){this.itemEl.querySelectorAll("[data-dynamicPage-script]").forEach((function(e){var t=e.getAttribute("src");if(t)if(-1!==t.indexOf("instagram")&&window.instgrm)try{window.instgrm.Embeds.process()}catch(e){}else{var a=document.createElement("script");a.type="text/javascript",a.src=t,document.body.appendChild(a)}else{var s=document.createElement("script");s.text=e.innerHTML,e.parentNode.replaceChild(s,e)}}))}addModules(){this.param=JSON.parse(this.itemEl.getAttribute("data-dynamicPage-item"));const e={dynamicPageItem:this};this.modules=APP.manager.run(this.itemEl,"data-dynamicPage-modules",e)}checkNextPage(){this.param.next||y()}},c=function(){if(!o){var t=document.documentElement.clientHeight;if(e.getBoundingClientRect().bottom-t<500){const e=i[i.length-1];if(e.param&&!e.param.next)return;const t=new d(e);i.push(t)}h()}},h=function(){t&&clearTimeout(t),t=setTimeout(u,200)},u=function(){p(),t=!1},p=function(){var e=document.documentElement.clientHeight/2,t=!1;if(i.some((function(a,s){var i=a.itemEl.getBoundingClientRect();if(i.top<=e&&i.bottom>=e)return t=s,!0})),r!=(t=t||0)){var a=i[r=t];window.history.pushState({module:"DynamicPage",ind:t},"",a.url),function(e){document.title=e.title||"",l.ogTitle&&l.ogTitle.setAttribute("content",e.title||""),l.ogUrl&&l.ogUrl.setAttribute("content",e.url||"")}({title:a.param.title,url:a.url}),m(a.url)}},m=function(e){try{APP.bases.sendAnalytics({type:"page",pagePath:e})}catch(e){}},v=function(e){e.state&&(window.removeEventListener("scroll",c),window.scrollTo(0,0),window.location.reload(!0))},y=function(){n.forEach((e=>{e.tag.removeEventListener(e.eName,e.func)}))};!function(){const e=new d;i.push(e),e.param.next&&(n.push(APP.bases.helpers.throttle("scroll",c)),n.push(APP.bases.helpers.throttle("resize",c)),n.push(APP.bases.helpers.throttle("orientationChange",c)),window.history.replaceState({module:"DinamicPage",ind:0},location.href),window.addEventListener("popstate",v),c())}()};const f=function(){APP.vars.astraone&&(APP.vars.astraone=!1,["sdk","sdk_review"].forEach((e=>{!function(e){var t=document.createElement("script");t.async=!0,t.src="//cdn.afp.ai/ssp/"+e+".js",(document.head||document.getElementsByTagName("head")[0]).appendChild(t)}(e)})))},g=function(e,t,a,s){if(!APP.vars.inImage)return;APP.vars.inImage=!1;const i=JSON.parse(e.getAttribute("data-param"))||{};var r=r||{};r.que=r.que||[],r.que.push((function(){r.addAdUnits(adUnits),r.requestBids({bidsBackHandler:function(e){if(!r.adserverRequestSent){r.adserverRequestSent=!0;var t=r.getAdserverTargetingForAdUnitCode(i.inImageId),a=document.getElementById(i.inImageId);t&&t.hb_adid&&(a.parentElement.style.position="relative",a.style.display="block",r.renderAd(a.contentDocument,t.hb_adid))}}})}))},b=class{constructor(e,t,a,s){this._createElements(e,t,a,s),this._addEvents(),this._addToGlobal()}_createElements(e,t,a,s){this.wrapper=e,this.data=s,this.param=JSON.parse(this.wrapper.getAttribute("data-param")),this.btn=this._getBtn(),this.isFav=-1!==this.wrapper.className.indexOf("js-fav"),this.isSending=!1,this.unique=this._defineUnique(),this.onchange=function(){},this.ajaxPath=this.unique.path,this.request=new APP.bases.helpers.XHR(this.ajaxPath)}_defineUnique(){let e,t,a,s;return this.param.type==this.param.type&&(e=this.param.type,t=("uid_"+this.param.uid).replace(/-/g,""),a={type:this.param.type,uid:this.param.uid}),s=APP.settings.Fav.path.common.replace(/\[(.+?)\]/g,((e,t)=>a[t])),{type:e,uidKey:t,path:s,sendingData:{fav:!1}}}_getBtn(){return this.wrapper.hasAttribute("data-Fav-btn")?this.wrapper:this.wrapper.querySelector("[data-Fav-btn]")}_addEvents(){var e=this;this._onFav=(t,a)=>{const s=!e.isFav;if(a){if(!t.target.closest("[data-Fav-btn]"))return}else t.preventDefault(),t.stopPropagation();!0!==e.param.saveLocally?APP.bases.helpers.checkAuth()&&e._sendAjax.call(e,s):this._checkAnswer({status:!0,data:s})},this.btn.addEventListener("click",this._onFav)}_sendAjax(e){if(this.isSending)return!1;this.isSending=!0,this.unique.sendingData.fav=e,this.request.send(this.unique.sendingData).then((e=>{this._checkAnswer(e)}))}_showFavPopup(){page("howFav")}_checkAnswer(e){!1===e.auth?uPopup({content:e.message||"Вам нужно авторизоваться повторно.",oncloseBefore:function(){location.replace(location.protocol+"//"+location.host+location.pathname)}}):e.status?(e.data?(this.addToFav(),this._sendStat()):this._removeFromFav(),this.data&&this.data.callbacks&&this.data.callbacks.onFavChange&&(e.type=this.param.type,e.uid=this.param.uid,e.saveLocally=this.param.saveLocally,this.data.callbacks.onFavChange(e))):uPopup({content:e.message}),this.isSending=!1}_sendStat(){if(!this.param.saveLocally)switch(this.param.type){case"movies":try{APP.bases.sendAnalytics("movie_click_favorite")}catch(e){}break;case"series":try{APP.bases.sendAnalytics("series_click_favorite")}catch(e){}break;case"cinema":try{APP.bases.sendAnalytics("cinema_click_favorite")}catch(e){}}}addToFav(){for(var e=this.unique.uidKey,t=this.unique.type,a=APP.favAll[t][e],s=0,i=a.length;s<i;s++)a[s].wrapper.classList.add("js-fav"),a[s].isFav=!0;this.onchange(!0),this._addCustomEvent({isFav:!0,typeFav:t,uid:this.param.movieId})}_removeFromFav(){for(var e=this.unique.uidKey,t=this.unique.type,a=APP.favAll[t][e],s=0,i=a.length;s<i;s++)a[s].wrapper.classList.remove("js-fav"),a[s].isFav=!1;this.onchange(!1),this._addCustomEvent({isFav:!1,typeFav:t,uid:this.param.movieId})}_addCustomEvent(e){if(window.CustomEvent){var t=new Event(e.typeFav+"ChangeFav");t.isFav=e.isFav,t.uid=e.uid,document.dispatchEvent(t)}}_addToGlobal(){const e=this.unique.uidKey,t=this.unique.type;APP.favAll||(APP.favAll={}),APP.favAll[t]||(APP.favAll[t]={}),APP.favAll[t][e]||(APP.favAll[t][e]=[]),APP.favAll[t][e].push(this)}destroy(){this.btn.removeEventListener("click",this._onFav);const e=this.unique.uidKey,t=this.unique.type;let a=APP.favAll[t][e];for(var s=0,i=a.length;s<i;s++)if(a[s]===this)return a.splice(s,1),a.length||delete APP.favAll[t][e],!1}};class _{constructor(e){APP.SubContent||(APP.SubContent=this,this._createElements(e),this._addEvents(),this._runModules())}_createElements(e){var t=this;this.wrapper=e,this.param=JSON.parse(this.wrapper.getAttribute("data-param")),this.tabAll=this._getTabAll(),this.frame=document.querySelector("[data-SubContent-frame]"),this.innerTag=document.querySelector("[data-SubContent-inner]"),this.scrollToElement=function(){try{return document.getElementById(t.param.scrollTo)||t.frame}catch(e){return t.frame}}(),this.anchor,this.curInd}_getTabAll(){for(var e={},t=this.wrapper.querySelectorAll("[data-SubContent-btn]"),a=t.length,s=0;s<a;s++){let a=t[s].getAttribute("data-SubContent-btn");a=function(){try{return JSON.parse(a)}catch(e){return{name:a}}}(),e[a.name]={tag:t[s],data:a}}return e}_addEvents(){if(!window.history)return!1;var e=this;for(var t in this._popstateOnCircuit=function(t){e._popstateOn.call(e,t)},window.addEventListener("popstate",e._popstateOnCircuit),this.tabAll){const a=this.tabAll[t].tag,s=this.tabAll[t].data;-1!==a.className.indexOf("js-active")&&(this.curInd=t,window.history.replaceState({ind:t,pathname:window.location.pathname,search:window.location.search},"",window.location.href)),s.link||a.addEventListener("click",function(t){return function(a){e.show.call(e,this,a,t)}}(t))}}animate(e){return new class{constructor(){this._createElements(),this.run()}_createElements(){this.req=void 0,this.start=void 0}run(){var t=this;this.start=performance.now(),this.req=requestAnimationFrame((function a(s){var i=(s-t.start)/e.duration;i>1&&(i=1);var r=e.timing(i);e.draw(r),i<1&&(t.req=requestAnimationFrame(a))}))}stop(){cancelAnimationFrame(this.req)}}}show(e,t,a,s){this.anchor||(this.anchor=this.wrapper.parentNode.querySelector("[data-Subcontent-anchor]")),this.anchor||console.warn("отсутствует якорь к которому должно подъезжать меню"),!s&&this.anchor&&this._scrollTo(this.anchor),this._switchTab(e,t,a,s)}_scrollTo(e){try{APP.header.willScrollTo(e)}catch(e){}const t=e.getBoundingClientRect().top+window.pageYOffset,a=window.pageXOffset;window.scrollTo({left:a,top:t})}_switchTab(e,t,a,s){var i={};t.preventDefault(),window.history.pushState({ind:a,pathname:e.pathname,search:e.search},"",e.pathname+e.search),this._sendStat(e.pathname+e.search),i.data=this._getAjaxData(e.search),i.url=e.pathname,this._prepare(a,i,s)}_getAjaxData(e){var t={};if(!e)return t;for(var a=0,s=(e=e.replace("?","").split("&")).length;a<s;a++){var i=e[a].split("=");t[i[0]]=i[1]}return t}_popstateOn(e){var t={};e.state&&(t.data=this._getAjaxData(e.state.search),t.url=e.state.pathname,this._sendStat(e.state.pathname+e.state.search),this._prepare(e.state.ind,t))}_prepare(e,t,a){const s=this.tabAll[e].tag,i=this.tabAll[this.curInd].tag;s.classList.add("js-active"),i.classList.remove("js-active"),this.curInd=e,-1===this.frame.className.indexOf("js-loading")&&(this.frame.className=this.frame.className+" js-loading"),this.moduleAllRemove(),this.getContent(t,a)}getContent(e,t){this.request&&this.request.abort("SubContent"),this.request=new APP.bases.helpers.XHR(e.url),this.request.send(e.data).then((e=>{this._addContent(e,t)}))}_addContent(e,t){if(e.status&&(this._addCss(e.css),this.innerTag.innerHTML=e.html,this._runModules(),t)){var a=document.getElementById(t);if(null===a)return;this._scrollTo(a)}this.frame.className=this.frame.className.replace(" js-loading","")}_addCss(e){APP.bases.helpers.addCss(e)}_sendStat(e){try{APP.bases.sendAnalytics({type:"page",pagePath:e})}catch(e){}}moduleAllRemove(){APP.manager.destroy(this.moduleAll),this.moduleAll=void 0}_runModules(){this.moduleAll=APP.manager.run(this.frame,"data-sub-modules",{SubContent:this})}destroy(){window.removeEventListener("popstate",this._popstateOnCircuit),this.request.abort("SubContent"),APP.manager.destroy(this.moduleAll)}}__webpack_require__(402);class P{constructor(e,t,a,s){this.oPlayer,this.wrapper=e,this.settings=t,this.initialEvent=a,this.data=s,this.allModules=APP.manager.run(this.wrapper,"data-MyPlayer-modules"),this._init(e)}_init(){const e=JSON.parse(this.wrapper.getAttribute("data-param"));let t=function(){if(e.forPlayer.ads)return e.forPlayer.ads;let t=e.ads;if(!t)return!1;Date.now();const a=encodeURIComponent(location.protocol+"//"+location.hostname+location.pathname),s={YaSDK:{settings:{adFoxParameters:{ownerId:"275464",params:{p1:"cdxbp",p2:"ghrm"}}}},Bestseller:{settings:{adFoxParameters:{ownerId:"254954",params:{p1:"cvtgr",p2:"gbrl"}}}},IMXO:{getPath:()=>{var e=Math.floor((new Date).getTime()/1e3)+Math.floor(214748364*Math.random()),t=(new Date).getTime()+""+Math.floor(2147483647*Math.random());return"https://yandex.ru/ads/adfox/226279/getCode?pp=eez&ps=defw&p2=eyit&pfc=a&pfb=a&plp=a&pli=a&pop=a&pct=d&puid5=1&puid6=1&puid30=21834&pr="+e+"&dl=http://kinoafisha.info/default/:"+a+"&eid1=21834:"+t+":"+e}}},i={timeLine:{}};return i.timeLine.preroll={},i.timeLine.preroll.queue=function(){if(!t.agents)return[{name:"Bestseller",format:"YaSDK",settings:s.Bestseller.settings},{name:"YaSDK",format:"YaSDK",settings:s.YaSDK.settings}]}(),i}();const a=e.forPlayer;a.ads=t,a.share={link:e.pageLink||!1,embed:{width:640,height:360,code:'<iframe title="Kinoafisha player" width="640" height="360" src="https://api.kinoafisha.info/player/embed/'+e.trailer_id+'" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" allowfullscreen></iframe>'}},a.callbacks={onRun:()=>{try{this.data.callbacks.onRun()}catch(e){}},onEnd:()=>{try{this.data.callbacks.onEnd()}catch(e){}},video:{onStart:()=>{try{this.data.callbacks.video.onStart()}catch(e){}}},ads:{onDataRequest:e=>{try{gtag("event","request",{event_category:"video",event_label:"ads",value:e}),console.log("rquest_video_ads sending")}catch(e){console.warn("rquest_video_ads not sending")}},onClick:()=>{console.log("Произошел клик по рекламе")},onEnd:e=>{console.log("Проигрывание всей рекламы закончилось",e)}}},this.paramForPlayer=a,this.oPlayer=videoPlayer(this.wrapper,a)}reload(e){if(e){e.files&&this.paramForPlayer.youtube&&delete this.paramForPlayer.youtube;for(let t in e)e.hasOwnProperty(t)&&(this.paramForPlayer[t]=e[t])}this.oPlayer.destroy(),this.oPlayer=videoPlayer(this.wrapper,this.paramForPlayer)}destroy(){APP.manager.destroy(this.allModules),this.oPlayer.destroy()}}var w=class{constructor(e){this._createElements(e)}_createElements(e){this.wrapper=e,this.param=JSON.parse(this.wrapper.getAttribute("data-param")),this.moduleFrameAll=APP.manager.run(this.wrapper,"data-trailer-modules",(e=>{if("MyPlayer"===e.name)return{callbacks:{onRun:()=>{this.wrapper.classList.add("js-active")},onEnd:()=>{this.wrapper.classList.remove("js-active")}}}}))}destroy(){APP.modules.destroy(this.moduleFrameAll)}};function A(e){const t=e.querySelectorAll("[data-oEmbed-tag]");if(!t.length)return;const a=new Worker(APP.vars.workersPath+"js/workers/oEmbed-worker.js?2");a.onmessage=function(e){const t=e.data;i[t.ind].addSizes(t.response)};const s=APP.settings.oEmbed;let i=[];t.forEach(((e,t)=>{i[t]=new class{constructor(e,t){this._checkSize(e)||(this._declare(e,t),this._createWorker())}_checkSize(e){if(e.style.getPropertyValue("--embedPaddingTop"))return!0}_declare(e,t){this.ind=t,this.tag=e,this.param=JSON.parse(e.getAttribute("data-param"))}_createWorker(){this.param&&a.postMessage({settings:s,param:this.param,width:this.tag.getBoundingClientRect().width,ind:this.ind})}addSizes(e){e.paddingTop&&(!0===e.remove?this.tag.parentNode.removeChild(this.tag):("image"==this.param.name&&this.tag.classList.add("js-oEmbed"),this.tag.style.setProperty("--embedPaddingTop",e.paddingTop)))}}(e,t)}))}const k={getCookie:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0},setCookie:function(e,t,a={}){var s=(a={path:"/",domain:location.hostname.split(".").slice(-2).join("."),...a}).expires;if("number"==typeof s&&s){var i=new Date;i.setTime(i.getTime()+1e3*s),s=a.expires=i}s&&s.toUTCString&&(a.expires=s.toUTCString());var r=e+"="+(t=encodeURIComponent(t));for(var o in a){r+="; "+o;var n=a[o];!0!==n&&(r+="="+n)}document.cookie=r},deleteCookie:function(e){this.setCookie(e,"",{expires:-1})}},S=function(e){const t=function(e,t){"page"===e?(function(e){const t=e.pagePath||location.pathname;try{yaCounter28763351.hit(t)}catch(e){console.log(`YA Page error.\n url: ${t},\n ${e}`)}}(t),function(e){const{pageTitle:t,pageLocation:a,pagePath:s,sendPageView:i}=e,r={page_title:t||document.title,page_location:a||location.href,page_path:s||location.pathname,send_page_view:i||!0};try{gtag("config","UA-21667993-5",r)}catch(e){console.log(`GA Page error.\n page_path: ${s},\n ${e}`)}}(t)):(console.log("sending analytics",t),function(e){const{uid:t,value:a=null}=e;try{yaCounter28763351.reachGoal(t,{value:a})}catch(e){console.log(`YA Event error.\n uid: ${t}, value: ${a}\n ${e}`)}}(t),function(e){const{uid:t,value:a,redirectLink:s}=e,[i,r,o]=t.split("_"),n={event_category:i,event_label:o};void 0!==a&&Object.assign(n,{value:a}),s&&Object.assign(n,{transport_type:"beacon",event_callback:function(){document.location=s}});try{gtag("event",r,n)}catch(e){console.log(`GA Event error.\n uid: ${t}, value: ${a}\n ${e}`)}}(t))};!function(e){const{isElement:a,analyticData:s}=function(e){const t=({type:e,initialEvent:t,...s})=>a.analyticData.push({type:e,initialEvent:t,sendingData:s});let a={isElement:e instanceof Element,analyticData:[]};if(a.isElement){const t=e.hasAttribute("data-sendAnalytics-param")?"data-sendAnalytics-param":"data-param";e=e.getAttribute(t);try{e=JSON.parse(e)}catch(e){}}return"string"==typeof e?a.analyticData.push({sendingData:{uid:e}}):e.targets?e.targets.forEach(t):t(e),a}(e);s.forEach((s=>{const{type:i="event",initialEvent:r="click",sendingData:o}=s;if(a&&"ready"!==r&&"page"!==i)if("observe"===r){let a=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(a.disconnect(),a=null,t(i,o))}))}));a.observe(e)}else e.addEventListener(r,t.bind(null,i,o));else t(i,o)}))}(e)};APP.manager=t.B,APP.bases=e,APP.settings=a,APP.vars.mobileAgent=APP.bases.helpers.getMobileAgent(),APP.vars.isAdBlock=void 0,s((function(){APP.bases.page.init(),APP.manager.run()})),APP.cmds.forEach((function(e){e()})),APP.cmds.push=function(e){e()}})()})();